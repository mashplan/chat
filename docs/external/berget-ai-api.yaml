openapi: 3.0.0
info:
  title: Berget AI API
  version: 5.0.9
  description: >-
    Official API for the Berget AI platform - Access our powerful AI models
    through a simple chat API, manage your API keys, track usage, and handle
    team members and billing. Berget AI is an EU-based AI service providing APIs
    for serving open source models.


    ## Getting Started


    The easiest way to get started is to use our CLI tool:


    1. Login or create an account: `npx berget auth login`

    2. Create an API key: `npx berget api-keys create --name my-first-key`


    You can then use this API key to authenticate your API requests.
  contact:
    name: Berget AI Support
    url: https://berget.ai/support
    email: support@berget.ai
  license:
    name: Proprietary
    url: https://berget.ai/terms
servers:
  - url: https://api.berget.ai
    description: Production API
  - url: https://api.staging.berget.ai
    description: Staging API
tags:
  - name: Auth
    description: Authentication endpoints for login, registration, and token management
  - name: Users
    description: User management endpoints for team members and profiles
  - name: Models
    description: AI model endpoints for listing and using available models
  - name: API Keys
    description: API key management for programmatic access
  - name: Chat
    description: Chat completion endpoints for AI interactions
  - name: Embeddings
    description: Create vector embeddings from text for semantic search and
      similarity comparisons
  - name: Rerank
    description: Rerank documents based on their relevance to a specific query
  - name: Audio
    description: Audio processing endpoints including transcription services
  - name: Clusters
    description: Kubernetes cluster management and monitoring
  - name: Usage
    description: Usage statistics and billing information
  - name: Health
    description: API health status and monitoring endpoints
  - name: OCR
    description: Document processing and OCR capabilities
x-tagGroups:
  - name: Authentication & User Management
    tags:
      - Auth
      - Users
  - name: Core product
    tags:
      - Chat
      - Models
      - API Keys
      - OCR
      - Embeddings
      - Rerank
      - Audio
  - name: Compute and Storage
    tags:
      - Clusters
      - Health
  - name: Usage and Billing
    tags:
      - Usage
      - Billing
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "Enter your JWT token as: Bearer <token>"
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: An error occurred while processing the request
        code:
          type: string
          description: Error code
          example: PROCESSING_ERROR
        details:
          nullable: true
          description: Additional error details
          example:
            field: document
            reason: Invalid format
      required:
        - error
        - code
    AuthToken:
      type: object
      properties:
        accessToken:
          type: string
        expiresIn:
          type: number
        user:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
            email:
              type: string
              format: email
          required:
            - id
            - name
            - email
      required:
        - accessToken
        - expiresIn
    RefreshTokenRequest:
      type: object
      properties:
        refresh_token:
          type: string
          minLength: 1
          description: The refresh token to use
        is_device_token:
          type: boolean
          description: Whether this is a device token
      required:
        - refresh_token
    RefreshTokenResponse:
      type: object
      properties:
        token:
          type: string
          description: The new access token
        refresh_token:
          type: string
          description: The new refresh token
        expires_in:
          type: number
          description: Seconds until the access token expires
        refresh_expires_in:
          type: number
          description: Seconds until the refresh token expires
      required:
        - token
        - refresh_token
        - expires_in
        - refresh_expires_in
    DeviceAuthRequest:
      type: object
      properties:
        device_code:
          type: string
          description: The device code obtained from the device authorization request
      required:
        - device_code
    DeviceAuthInitResponse:
      type: object
      properties:
        device_code:
          type: string
          description: Code used by the device to poll for authentication status
        user_code:
          type: string
          description: Code displayed to the user for authentication
        verification_url:
          type: string
          description: URL where the user should enter the user_code
        expires_in:
          type: number
          description: Expiration time in seconds
        interval:
          type: number
          description: Polling interval in seconds
      required:
        - device_code
        - user_code
        - verification_url
        - expires_in
        - interval
    DeviceAuthPendingResponse:
      type: object
      properties:
        status:
          type: string
          enum:
            - pending
          description: Authentication is still pending
      required:
        - status
    DeviceAuthTokenResponse:
      type: object
      properties:
        token:
          type: string
          description: Access token
        refresh_token:
          type: string
          description: Refresh token
        expires_in:
          type: number
          description: Access token expiration time in seconds
        refresh_expires_in:
          type: number
          description: Refresh token expiration time in seconds
      required:
        - token
        - refresh_token
        - expires_in
        - refresh_expires_in
    Registration:
      type: object
      properties:
        user:
          type: object
          properties:
            name:
              type: string
              minLength: 2
              description: Full name of the user
            email:
              type: string
              format: email
              description: User's email address
            phone:
              type: string
              description: Contact phone number
            password:
              type: string
              minLength: 8
              description: User password for authentication
            language:
              type: string
              description: Preferred interface language (e.g., en_US, sv_SE)
            timezone:
              type: string
              description: Preferred timezone (e.g., Europe/Stockholm, America/New_York)
          required:
            - name
            - email
            - password
          description: User information
        stripeCustomerId:
          type: string
          description: Stripe customer ID for existing customers
        company:
          type: object
          properties:
            name:
              type: string
              description: Legal company name
            vatNumber:
              type: string
              description: VAT identification number
            email:
              type: string
              format: email
              description: Company email address
            phone:
              type: string
              description: Company phone number
            address:
              type: object
              properties:
                street:
                  type: string
                  description: Street address
                city:
                  type: string
                  description: City
                zip:
                  type: string
                  description: Postal/ZIP code
                countryCode:
                  type: string
                  description: ISO country code
              description: Company address information
          required:
            - name
          description: Company details for business users
        plans:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                description: Product plan ID
              quantity:
                type: integer
                minimum: 0
                exclusiveMinimum: true
                default: 1
                description: Quantity of licenses
            required:
              - id
          description: Product plans to subscribe to
        marketingConsent:
          type: boolean
          default: false
          description: Consent to receive marketing communications
        termsAccepted:
          type: boolean
          description: Acceptance of terms and conditions
      required:
        - user
        - termsAccepted
    UserProfile:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the user
        email:
          type: string
          format: email
          description: User's email address
        name:
          type: string
          description: Full name of the user
        phone:
          type: string
          nullable: true
          description: Contact phone number
        partnerId:
          type: number
          description: ID of the company the user belongs to
        login:
          type: string
          description: Username for login
        role:
          type: string
          enum:
            - admin
            - member
          description: User role determining permissions
        active:
          type: boolean
          nullable: true
          description: Whether the user account is active
        createdAt:
          type: string
          nullable: true
          format: date-time
          description: When the user was created
        updatedAt:
          type: string
          nullable: true
          format: date-time
          description: Last update timestamp
        isIndividual:
          type: boolean
          description: Whether this is an individual user account
        settings:
          type: object
          properties:
            notifications:
              type: boolean
              default: true
              description: Email notification preferences
            timezone:
              type: string
              default: Europe/Stockholm
              description: User's preferred timezone
            language:
              type: string
              default: en
              description: Preferred interface language
            theme:
              type: string
              enum:
                - light
                - dark
                - system
              default: system
              description: UI theme preference
          description: User preferences and settings
        company:
          type: object
          properties:
            id:
              type: number
              description: Company unique identifier
            name:
              type: string
              description: Legal company name
            vatNumber:
              type: string
              description: VAT identification number
            email:
              type: string
              format: email
              description: Company email address
            phone:
              type: string
              nullable: true
              description: Company phone number
            address:
              type: object
              properties:
                street:
                  type: string
                  description: Street address
                city:
                  type: string
                  description: City
                zip:
                  type: string
                  description: Postal/ZIP code
                countryCode:
                  type: string
                  description: ISO country code
            country:
              type: object
              nullable: true
              properties:
                id:
                  type: number
                  description: Country ID
                name:
                  type: string
                  description: Country name
                code:
                  type: string
                  description: ISO country code
              required:
                - id
                - name
                - code
              description: Company country information
          required:
            - id
            - name
            - phone
            - country
          description: Associated company details
        subscription:
          type: object
          properties:
            status:
              type: string
              enum:
                - active
                - trialing
                - past_due
                - canceled
                - unpaid
              description: Current subscription status
            currentPeriodEnd:
              type: string
              format: date-time
              description: End date of current billing period
            plans:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: Plan ID
                  name:
                    type: string
                    description: Plan name
                  quantity:
                    type: number
                    description: Number of licenses
                required:
                  - id
                  - name
                  - quantity
              description: Active subscription plans
          required:
            - status
            - currentPeriodEnd
            - plans
          description: Subscription information
      required:
        - id
        - email
        - name
        - phone
        - partnerId
        - login
        - role
        - active
        - createdAt
        - updatedAt
      description: Complete user profile including company details
    RegistrationResponse:
      type: object
      properties:
        user:
          $ref: "#/components/schemas/UserProfile"
        token:
          type: string
          description: Authentication token if available
      required:
        - user
    RegistrationError:
      type: object
      properties:
        code:
          type: string
          enum:
            - EMAIL_ALREADY_EXISTS
            - COMPANY_ALREADY_EXISTS
            - INVALID_VAT_NUMBER
            - MISSING_COUNTRY_CODE
            - PAYMENT_REQUIRED
            - INVALID_PLAN
            - COMPANY_CREATION_FAILED
            - USER_CREATION_FAILED
            - SUBSCRIPTION_FAILED
            - VALIDATION_ERROR
            - SERVER_ERROR
          description: Error code
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          additionalProperties:
            nullable: true
          description: Additional error details
        validationErrors:
          type: array
          items:
            type: object
            properties:
              path:
                type: array
                items:
                  type: string
                description: Path to the field with error
              message:
                type: string
                description: Error message for this field
            required:
              - path
              - message
          description: Validation errors
      required:
        - code
        - message
    User:
      type: object
      properties:
        id:
          type: string
          description: User ID
        email:
          type: string
          format: email
          description: User email address
        name:
          type: string
          description: User full name
        roles:
          type: array
          items:
            type: string
          description: User roles
        partnerId:
          type: string
          description: Company ID
        keycloakId:
          type: string
          description: Authentication provider ID
      required:
        - id
        - email
        - name
        - roles
        - partnerId
        - keycloakId
    CreateUser:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          description: Full name of the user
        email:
          type: string
          format: email
          description: User's email address
        phone:
          type: string
          description: Contact phone number
        role:
          type: string
          enum:
            - admin
            - member
          description: User role
        settings:
          type: object
          properties:
            notifications:
              type: boolean
              default: true
              description: Email notification preferences
            timezone:
              type: string
              default: Europe/Stockholm
              description: User's preferred timezone
            language:
              type: string
              default: en
              description: Preferred interface language
            theme:
              type: string
              enum:
                - light
                - dark
                - system
              default: system
              description: UI theme preference
      required:
        - name
        - email
        - role
    UpdateUser:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          description: Full name of the user
        email:
          type: string
          format: email
          description: User's email address
        phone:
          type: string
          description: Contact phone number
        settings:
          type: object
          properties:
            notifications:
              type: boolean
              default: true
              description: Email notification preferences
            timezone:
              type: string
              default: Europe/Stockholm
              description: User's preferred timezone
            language:
              type: string
              default: en
              description: Preferred interface language
            theme:
              type: string
              enum:
                - light
                - dark
                - system
              default: system
              description: UI theme preference
    InviteUser:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Email address of the person to invite
        role:
          type: string
          enum:
            - admin
            - member
          description: Role to assign to the new team member
        companyId:
          type: number
          description: Company ID to invite the user to (defaults to current user's company)
      required:
        - email
        - role
    ModelPricing:
      type: object
      properties:
        input:
          type: number
          description: Cost per token for input in the specified currency
        output:
          type: number
          description: Cost per token for output in the specified currency
        unit:
          type: string
          description: The unit of pricing (e.g., "token")
        currency:
          type: string
          description: The currency of the pricing (e.g., "USD")
      required:
        - input
        - output
        - unit
        - currency
      description: Pricing information for the model
    ModelCapabilities:
      type: object
      properties:
        vision:
          type: boolean
          default: false
          description: Whether the model supports vision/image input
        function_calling:
          type: boolean
          default: false
          description: Whether the model supports function calling
        json_mode:
          type: boolean
          description: Whether the model supports JSON mode
        classification:
          type: boolean
          default: false
          description: Whether the model supports classification tasks
        embeddings:
          type: boolean
          default: false
          description: Whether the model supports generating embeddings
        formatted_output:
          type: boolean
          default: false
          description: Whether the model supports formatted output
        streaming:
          type: boolean
          default: false
          description: Whether the model supports streaming output
      required:
        - json_mode
      description: Capabilities of the model
    Model:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the model
        name:
          type: string
          description: Name of the model
        description:
          type: string
          description: Description of the model
        object:
          type: string
          enum:
            - model
          description: Object type, always "model"
        created:
          type: number
          description: Unix timestamp when this model was created
        owned_by:
          type: string
          description: Organization that owns the model
        permission:
          type: array
          items:
            nullable: true
          description: List of permissions
        root:
          type: string
          description: Root model ID
        parent:
          type: string
          nullable: true
          description: Parent model ID
        pricing:
          $ref: "#/components/schemas/ModelPricing"
        capabilities:
          $ref: "#/components/schemas/ModelCapabilities"
        status:
          type: object
          properties:
            up:
              type: boolean
              default: false
              description: Status of the model
      required:
        - id
        - name
        - object
        - created
        - owned_by
        - permission
        - root
        - parent
        - status
    ModelList:
      type: object
      properties:
        object:
          type: string
          enum:
            - list
          description: Object type, always "list"
        data:
          type: array
          items:
            $ref: "#/components/schemas/Model"
          description: List of models
      required:
        - object
        - data
    ApiKey:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the API key
        name:
          type: string
          description: Name of the API key
        description:
          type: string
          nullable: true
          description: Description of the API key
        active:
          type: boolean
          description: Whether the API key is active
        created:
          type: string
          format: date-time
          description: Creation timestamp
        modified:
          type: string
          format: date-time
          description: Last modification timestamp
        lastUsed:
          type: string
          nullable: true
          format: date-time
          description: Last usage timestamp
        prefix:
          type: string
          description: API key prefix (for display purposes)
      required:
        - id
        - name
        - description
        - active
        - created
        - modified
        - lastUsed
        - prefix
    ApiKeyResponse:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the API key
        name:
          type: string
          description: Name of the API key
        description:
          type: string
          nullable: true
          description: Description of the API key
        active:
          type: boolean
          description: Whether the API key is active
        created:
          type: string
          format: date-time
          description: Creation timestamp
        modified:
          type: string
          format: date-time
          description: Last modification timestamp
        lastUsed:
          type: string
          nullable: true
          format: date-time
          description: Last usage timestamp
        prefix:
          type: string
          description: API key prefix (for display purposes)
      required:
        - id
        - name
        - description
        - active
        - created
        - modified
        - lastUsed
        - prefix
    CreateApiKey:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          description: Name of the API key
        description:
          type: string
          description: Description of the API key
      required:
        - name
    CreateApiKeyResponse:
      type: object
      properties:
        name:
          type: string
          description: Name of the API key
        description:
          type: string
          nullable: true
          description: Description of the API key
        key:
          type: string
          description: The API key - only returned once at creation
        created:
          type: string
          format: date-time
          description: Creation timestamp
      required:
        - name
        - description
        - key
        - created
    ApiKeyUsageEntry:
      type: object
      properties:
        date:
          type: string
          description: Date in YYYY-MM-DD format
        count:
          type: number
          description: Number of requests on this date
      required:
        - date
        - count
    ApiKeyModelUsage:
      type: object
      properties:
        id:
          type: string
          description: Model identifier
        name:
          type: string
          description: Model display name
        requests:
          type: number
          description: Total number of requests to this model
        tokens:
          type: object
          properties:
            input:
              type: number
              description: Total input tokens
            output:
              type: number
              description: Total output tokens
            total:
              type: number
              description: Total tokens (input + output)
          required:
            - input
            - output
            - total
          description: Token usage statistics
      required:
        - id
        - name
        - requests
        - tokens
    ApiKeyUsageResponse:
      type: object
      properties:
        id:
          type: string
          description: API key ID
        name:
          type: string
          description: API key name
        requests:
          type: object
          properties:
            total:
              type: number
              description: Total number of requests
            daily:
              type: array
              items:
                $ref: "#/components/schemas/ApiKeyUsageEntry"
              description: Daily request counts
          required:
            - total
            - daily
          description: Request statistics
        models:
          type: array
          items:
            $ref: "#/components/schemas/ApiKeyModelUsage"
          description: Usage statistics per model
        period:
          type: object
          properties:
            start:
              type: string
              description: Start date of the period (YYYY-MM-DD)
            end:
              type: string
              description: End date of the period (YYYY-MM-DD)
          required:
            - start
            - end
          description: Time period for the usage data
      required:
        - id
        - name
        - requests
        - models
        - period
    ApiKeyListResponse:
      type: array
      items:
        $ref: "#/components/schemas/ApiKey"
    TextContent:
      type: object
      properties:
        type:
          type: string
          enum:
            - text
        text:
          type: string
      required:
        - type
        - text
    ImageContent:
      type: object
      properties:
        type:
          type: string
          enum:
            - image_url
        image_url:
          type: object
          properties:
            url:
              type: string
              description: The URL of the image or base64 data URL
            detail:
              type: string
              enum:
                - low
                - high
                - auto
              default: auto
              description: The detail level of the image. "high" will enable more detailed
                analysis but costs more.
          required:
            - url
      required:
        - type
        - image_url
    ContentItem:
      anyOf:
        - $ref: "#/components/schemas/TextContent"
        - $ref: "#/components/schemas/ImageContent"
    FunctionCall:
      type: object
      properties:
        name:
          type: string
          description: The name of the function to call
        arguments:
          type: string
          description: The arguments to call the function with, as a JSON string
      required:
        - name
        - arguments
      description: Function call details
    ToolCall:
      type: object
      properties:
        id:
          type: string
          description: The ID of the tool call
        type:
          type: string
          enum:
            - function
          description: The type of tool call
        function:
          $ref: "#/components/schemas/FunctionCall"
      required:
        - id
        - type
        - function
    ChatMessage:
      type: object
      properties:
        role:
          type: string
          enum:
            - system
            - user
            - assistant
            - function
            - tool
          default: user
        content:
          anyOf:
            - type: string
            - type: array
              items:
                $ref: "#/components/schemas/ContentItem"
            - nullable: true
          description: The content of the message. Can be a string or an array of content
            items.
        name:
          type: string
          description: The name of the author of this message
        function_call:
          $ref: "#/components/schemas/FunctionCall"
        tool_call_id:
          type: string
          description: The ID of the tool call this message is responding to
        tool_calls:
          type: array
          items:
            $ref: "#/components/schemas/ToolCall"
          description: The tool calls made by the assistant
      required:
        - content
    FunctionDefinition:
      type: object
      properties:
        name:
          type: string
          description: The name of the function
        description:
          type: string
          description: A description of what the function does
        parameters:
          type: object
          properties:
            type:
              type: string
              description: The type of the parameters object
            properties:
              type: object
              additionalProperties:
                type: object
                properties:
                  type:
                    type: string
                    description: The type of the parameter
                  description:
                    type: string
                    description: Description of the parameter
                  enum:
                    type: array
                    items:
                      type: string
                    description: Possible values for the parameter
                  properties:
                    type: object
                    additionalProperties:
                      nullable: true
                    description: "Properties of the object (for type: object)"
                  required:
                    type: array
                    items:
                      type: string
                    description: "Required properties (for type: object)"
                  items:
                    nullable: true
                    description: "Schema for array items (for type: array)"
                required:
                  - type
              description: The properties of the parameters object
            required:
              type: array
              items:
                type: string
              description: Required properties in the parameters object
          required:
            - type
          description: The parameters the function accepts
      required:
        - name
        - parameters
    Tool:
      type: object
      properties:
        type:
          type: string
          enum:
            - function
          description: The type of tool
        function:
          $ref: "#/components/schemas/FunctionDefinition"
      required:
        - type
        - function
    ToolChoice:
      anyOf:
        - type: string
          enum:
            - auto
            - none
        - type: object
          properties:
            type:
              type: string
              enum:
                - function
              description: The type of tool choice
            function:
              type: object
              properties:
                name:
                  type: string
                  description: The name of the function to call
              required:
                - name
              description: Function details
          required:
            - type
            - function
    ResponseFormat:
      type: object
      properties:
        type:
          type: string
          enum:
            - text
            - json_object
          default: text
          description: The format in which the model should return the response
        schema:
          type: object
          additionalProperties:
            nullable: true
          description: JSON Schema that the output should conform to
    ChatCompletionRequest:
      type: object
      properties:
        model:
          type: string
          default: mistralai/Mistral-Small-3.1-24B-Instruct-2503
          description: ID of the model to use. Defaults to
            mistralai/Mistral-Small-3.1-24B-Instruct-2503 which offers a good
            balance of quality and speed with a 32K context window.
        messages:
          type: array
          items:
            $ref: "#/components/schemas/ChatMessage"
        temperature:
          type: number
          minimum: 0
          maximum: 2
        max_tokens:
          type: number
        stream:
          type: boolean
          default: false
        top_p:
          type: number
          default: 1
        response_format:
          $ref: "#/components/schemas/ResponseFormat"
        json_mode:
          type: boolean
          description: Legacy parameter. Set to true if you want the model to return a
            JSON object. Use response_format instead.
        functions:
          type: array
          items:
            $ref: "#/components/schemas/FunctionDefinition"
          description: A list of functions the model may generate JSON inputs for
        function_call:
          anyOf:
            - type: string
              enum:
                - auto
                - none
            - type: object
              properties:
                name:
                  type: string
                  description: The name of the function to call
              required:
                - name
          description: Controls how the model uses functions
        tools:
          type: array
          items:
            $ref: "#/components/schemas/Tool"
          description: A list of tools the model may call
        tool_choice:
          allOf:
            - $ref: "#/components/schemas/ToolChoice"
            - description: Controls how the model uses tools
      required:
        - messages
    ChatCompletionResponse:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for this completion
        object:
          type: string
          enum:
            - chat.completion
        created:
          type: number
          description: Unix timestamp of when the completion was created
        model:
          type: string
          description: The model used for completion
        choices:
          type: array
          items:
            type: object
            properties:
              message:
                type: object
                properties:
                  role:
                    type: string
                    enum:
                      - assistant
                  content:
                    type: string
                    nullable: true
                    description: The model's response
                  function_call:
                    $ref: "#/components/schemas/FunctionCall"
                  tool_calls:
                    type: array
                    items:
                      $ref: "#/components/schemas/ToolCall"
                    description: The tool calls made by the assistant
                required:
                  - role
                  - content
              finish_reason:
                type: string
                enum:
                  - stop
                  - length
                  - content_filter
                  - tool_calls
                  - function_call
              index:
                type: number
            required:
              - message
              - finish_reason
              - index
        usage:
          type: object
          properties:
            prompt_tokens:
              type: number
            completion_tokens:
              type: number
            total_tokens:
              type: number
            co2_grams:
              type: number
              description: CO2 emissions in grams
          required:
            - prompt_tokens
            - completion_tokens
            - total_tokens
      required:
        - id
        - object
        - created
        - model
        - choices
        - usage
    Cluster:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the cluster
        name:
          type: string
          description: Display name of the cluster
        provider:
          type: string
          description: Cloud provider (AWS, GCP, Azure, etc.)
        region:
          type: string
          description: Cloud region where the cluster is deployed
        version:
          type: string
          description: Kubernetes version
        nodes:
          type: integer
          minimum: 0
          description: Number of nodes in the cluster
        status:
          type: string
          enum:
            - healthy
            - degraded
            - unhealthy
            - unknown
          description: Current status of the cluster
        created:
          type: string
          format: date-time
          description: Creation timestamp
      required:
        - id
        - name
        - provider
        - region
        - version
        - nodes
        - status
        - created
    ClusterList:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/Cluster"
        object:
          type: string
          enum:
            - list
      required:
        - data
        - object
    ResourceMetric:
      type: object
      properties:
        allocated:
          type: number
          description: Total allocated resources
        used:
          type: number
          description: Currently used resources
        available:
          type: number
          description: Available resources
        unit:
          type: string
          description: Unit of measurement (e.g., cores, GB)
      required:
        - allocated
        - used
        - available
        - unit
    ClusterCost:
      type: object
      properties:
        cpu:
          type: number
          description: Cost for CPU resources
        memory:
          type: number
          description: Cost for memory resources
        storage:
          type: number
          description: Cost for storage resources
        network:
          type: number
          description: Cost for network resources
        total:
          type: number
          description: Total cost
        currency:
          type: string
          description: Currency code (e.g., USD, EUR)
      required:
        - cpu
        - memory
        - storage
        - network
        - total
        - currency
      description: Cost breakdown
    ClusterUsage:
      type: object
      properties:
        id:
          type: string
          description: Unique cluster identifier
        name:
          type: string
          description: Cluster name
        resources:
          type: object
          properties:
            cpu:
              $ref: "#/components/schemas/ResourceMetric"
            memory:
              $ref: "#/components/schemas/ResourceMetric"
            storage:
              $ref: "#/components/schemas/ResourceMetric"
          required:
            - cpu
            - memory
            - storage
          description: Resource usage metrics
        cost:
          $ref: "#/components/schemas/ClusterCost"
        nodes:
          type: number
          description: Number of nodes in the cluster
        status:
          type: string
          description: Current cluster status
      required:
        - id
        - name
        - resources
        - cost
        - nodes
        - status
    ResourceMetricWithTrend:
      allOf:
        - $ref: "#/components/schemas/ResourceMetric"
        - type: object
          properties:
            usage_trend:
              type: array
              items:
                type: object
                properties:
                  date:
                    type: string
                    description: Date in YYYY-MM-DD format
                  value:
                    type: number
                    description: Resource usage value for this date
                required:
                  - date
                  - value
              description: Historical usage trend data
          required:
            - usage_trend
    DailyCost:
      type: object
      properties:
        date:
          type: string
          description: Date in YYYY-MM-DD format
        cpu:
          type: number
          description: CPU cost for this day
        memory:
          type: number
          description: Memory cost for this day
        storage:
          type: number
          description: Storage cost for this day
        network:
          type: number
          description: Network cost for this day
        total:
          type: number
          description: Total cost for this day
      required:
        - date
        - cpu
        - memory
        - storage
        - network
        - total
    ClusterCostWithDaily:
      allOf:
        - $ref: "#/components/schemas/ClusterCost"
        - type: object
          properties:
            daily:
              type: array
              items:
                $ref: "#/components/schemas/DailyCost"
              description: Daily cost breakdown
          required:
            - daily
      description: Detailed cost breakdown with daily data
    ClusterDetailedUsage:
      type: object
      properties:
        id:
          type: string
          description: Unique cluster identifier
        name:
          type: string
          description: Cluster name
        resources:
          type: object
          properties:
            cpu:
              $ref: "#/components/schemas/ResourceMetricWithTrend"
            memory:
              $ref: "#/components/schemas/ResourceMetricWithTrend"
            storage:
              $ref: "#/components/schemas/ResourceMetricWithTrend"
          required:
            - cpu
            - memory
            - storage
          description: Detailed resource usage metrics with trends
        cost:
          $ref: "#/components/schemas/ClusterCostWithDaily"
        nodes:
          type: number
          description: Number of nodes in the cluster
        status:
          type: string
          description: Current cluster status
        period:
          type: object
          properties:
            start:
              type: string
              description: Start date of the period (YYYY-MM-DD)
            end:
              type: string
              description: End date of the period (YYYY-MM-DD)
          required:
            - start
            - end
          description: Time period for the usage data
      required:
        - id
        - name
        - resources
        - cost
        - nodes
        - status
        - period
    ClustersUsageResponse:
      type: object
      properties:
        clusters:
          type: array
          items:
            $ref: "#/components/schemas/ClusterUsage"
          description: List of clusters with usage data
        period:
          type: object
          properties:
            start:
              type: string
              description: Start date of the period (YYYY-MM-DD)
            end:
              type: string
              description: End date of the period (YYYY-MM-DD)
          required:
            - start
            - end
          description: Time period for the usage data
        total:
          type: object
          properties:
            cost:
              type: object
              properties:
                cpu:
                  type: number
                  description: Total CPU cost across all clusters
                memory:
                  type: number
                  description: Total memory cost across all clusters
                storage:
                  type: number
                  description: Total storage cost across all clusters
                network:
                  type: number
                  description: Total network cost across all clusters
                total:
                  type: number
                  description: Total cost across all clusters
                currency:
                  type: string
                  description: Currency code (e.g., USD, EUR)
              required:
                - cpu
                - memory
                - storage
                - network
                - total
                - currency
              description: Total cost breakdown across all clusters
          required:
            - cost
          description: Aggregated totals
      required:
        - clusters
        - period
        - total
    TokenCost:
      type: object
      properties:
        amount:
          type: number
          description: Cost amount
        currency:
          type: string
          description: Currency code (e.g., USD, EUR)
      required:
        - amount
        - currency
      description: Cost information for this usage
    DailyTokenUsage:
      type: object
      properties:
        date:
          type: string
          description: Usage date in YYYY-MM-DD format
        model:
          type: string
          description: Model identifier
        input_tokens:
          type: number
          description: Number of input tokens used
        output_tokens:
          type: number
          description: Number of output tokens generated
        total_tokens:
          type: number
          description: Total tokens (input + output)
        cost:
          $ref: "#/components/schemas/TokenCost"
      required:
        - date
        - input_tokens
        - output_tokens
        - total_tokens
        - cost
    TokenUsageTotal:
      type: object
      properties:
        input_tokens:
          type: number
          description: Total input tokens for the period
        output_tokens:
          type: number
          description: Total output tokens for the period
        total_tokens:
          type: number
          description: Total tokens for the period
        cost:
          allOf:
            - $ref: "#/components/schemas/TokenCost"
            - description: Total cost information
      required:
        - input_tokens
        - output_tokens
        - total_tokens
        - cost
      description: Aggregated usage totals
    TokenUsagePeriod:
      type: object
      properties:
        start:
          type: string
          description: Start date of the period (YYYY-MM-DD)
        end:
          type: string
          description: End date of the period (YYYY-MM-DD)
      required:
        - start
        - end
      description: Time period for the usage data
    TokenUsageResponse:
      type: object
      properties:
        usage:
          type: array
          items:
            $ref: "#/components/schemas/DailyTokenUsage"
          description: Daily token usage data
        total:
          $ref: "#/components/schemas/TokenUsageTotal"
        period:
          $ref: "#/components/schemas/TokenUsagePeriod"
      required:
        - usage
        - total
        - period
    SubscriptionUsage:
      type: object
      properties:
        name:
          type: string
          description: Subscription name
        status:
          type: string
          description: Subscription status
        startDate:
          type: string
          description: Subscription start date
        createDate:
          type: string
          description: Subscription creation date
        partnerId:
          type: string
          description: Partner ID
        planCode:
          type: string
          description: Plan code
        endDate:
          type: string
          description: Subscription end date
        cancelDate:
          type: string
          description: Subscription cancellation date
        currentBillingPeriodStartDate:
          type: string
          description: Current billing period start date
        currentBillingPeriodEndDate:
          type: string
          description: Current billing period end date
        usage:
          type: object
          properties:
            currentUsageAmountCents:
              type: number
              description: Current usage amount in cents
            externalHistoricalUsageAmountCents:
              type: number
              description: External historical usage amount in cents
            fromDateTime:
              type: string
              description: Start date and time of usage
            toDateTime:
              type: string
              description: End date and time of usage
            invoicedUsageAmountCents:
              type: number
              description: Invoiced usage amount in cents
          required:
            - currentUsageAmountCents
            - externalHistoricalUsageAmountCents
            - fromDateTime
            - toDateTime
            - invoicedUsageAmountCents
          description: Usage data
      required:
        - name
        - status
        - startDate
        - createDate
        - partnerId
        - planCode
        - currentBillingPeriodStartDate
        - currentBillingPeriodEndDate
        - usage
      description: Subscription usage data
    ModelTokenUsageResponse:
      type: object
      properties:
        model:
          type: string
          description: Model identifier
        usage:
          type: array
          items:
            $ref: "#/components/schemas/DailyTokenUsage"
          description: Daily token usage data
        total:
          $ref: "#/components/schemas/TokenUsageTotal"
        period:
          $ref: "#/components/schemas/TokenUsagePeriod"
      required:
        - model
        - usage
        - total
        - period
    VatValidationRequest:
      type: object
      properties:
        vatNumber:
          type: string
          minLength: 3
          maxLength: 20
          pattern: ^[A-Z]{2}[0-9A-Z]+$
          description: VAT number with country code (e.g., SE123456789012)
        checkExisting:
          type: boolean
          default: true
          description: Whether to check if the company already exists in the system
      required:
        - vatNumber
    VatValidationResponse:
      type: object
      properties:
        valid:
          type: boolean
          description: Whether the VAT number is valid
        company:
          type: object
          properties:
            name:
              type: string
              description: Company name from VIES
            address:
              type: string
              description: Company address from VIES
            countryCode:
              type: string
              description: Country code
            vatNumber:
              type: string
              description: VAT number without country code
          required:
            - name
            - address
            - countryCode
            - vatNumber
          description: Company details if VAT is valid
        exists:
          type: boolean
          description: Whether the company already exists in our system
        companyId:
          type: number
          description: ID of the existing company if found
      required:
        - valid
    Plan:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the plan
        name:
          type: string
          description: Display name of the plan
        code:
          type: string
          description: Plan code
        description:
          type: string
          description: Plan description
        amount:
          type: number
          description: Plan price amount
        currency:
          type: string
          description: Currency code (e.g., USD, EUR)
        interval:
          type: string
          enum:
            - monthly
            - yearly
            - weekly
          description: Billing interval
        features:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                description: Feature name
              description:
                type: string
                description: Feature description
              included:
                type: boolean
                default: true
                description: Whether the feature is included
            required:
              - name
          description: Plan features
        isPopular:
          type: boolean
          description: Whether this is a popular/recommended plan
        trialDays:
          type: number
          description: Number of trial days
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Additional metadata
      required:
        - id
        - name
        - code
        - amount
        - currency
        - interval
    AppTemplate:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the app
        name:
          type: string
          description: Display name of the app
        category:
          type: string
          description: Category the app belongs to
        description:
          type: string
          description: Short description of the app
        installs:
          type: string
          description: Number of installations
        rating:
          type: number
          minimum: 0
          maximum: 5
          description: User rating
        icon:
          type: string
          description: Icon identifier
        features:
          type: array
          items:
            type: string
          description: List of key features
        requirements:
          type: object
          properties:
            cpu:
              type: number
              description: Required CPU cores
            memory:
              type: number
              description: Required memory in GB
            storage:
              type: number
              description: Required storage in GB
          required:
            - cpu
            - memory
            - storage
          description: Resource requirements
        configuration:
          type: array
          items:
            oneOf:
              - type: object
                properties:
                  name:
                    type: string
                    description: Configuration field name
                  type:
                    type: string
                    enum:
                      - string
                    description: String input type
                  required:
                    type: boolean
                    description: Whether this field is required
                  default:
                    type: string
                    description: Default value if any
                required:
                  - name
                  - type
                  - required
              - type: object
                properties:
                  name:
                    type: string
                    description: Configuration field name
                  type:
                    type: string
                    enum:
                      - number
                    description: Number input type
                  required:
                    type: boolean
                    description: Whether this field is required
                  default:
                    type: number
                    description: Default value if any
                required:
                  - name
                  - type
                  - required
              - type: object
                properties:
                  name:
                    type: string
                    description: Configuration field name
                  type:
                    type: string
                    enum:
                      - boolean
                    description: Boolean toggle type
                  required:
                    type: boolean
                    description: Whether this field is required
                  default:
                    type: boolean
                    description: Default value if any
                required:
                  - name
                  - type
                  - required
              - type: object
                properties:
                  name:
                    type: string
                    description: Configuration field name
                  type:
                    type: string
                    enum:
                      - select
                    description: Dropdown select type
                  required:
                    type: boolean
                    description: Whether this field is required
                  default:
                    type: string
                    description: Default selected option
                  options:
                    type: array
                    items:
                      type: string
                    description: Available options to select from
                required:
                  - name
                  - type
                  - required
                  - options
              - type: object
                properties:
                  name:
                    type: string
                    description: Configuration field name
                  type:
                    type: string
                    enum:
                      - password
                    description: Password input type
                  required:
                    type: boolean
                    description: Whether this field is required
                  default:
                    type: string
                    description: Default value if any
                required:
                  - name
                  - type
                  - required
          description: Configuration options
        ingress:
          type: object
          properties:
            enabled:
              type: boolean
              description: Whether ingress is enabled for this app
            hostname:
              type: string
              description: Hostname pattern for the ingress
            path:
              type: string
              description: Path for the ingress
            tls:
              type: boolean
              description: Whether TLS is enabled
          required:
            - enabled
            - hostname
            - path
            - tls
          description: Ingress configuration if applicable
      required:
        - id
        - name
        - category
        - description
        - installs
        - rating
        - icon
        - features
        - requirements
        - configuration
    AppTemplateList:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                description: Unique identifier for the app
              name:
                type: string
                description: Display name of the app
              category:
                type: string
                description: Category the app belongs to
              description:
                type: string
                description: Short description of the app
              installs:
                type: string
                description: Number of installations
              rating:
                type: number
                minimum: 0
                maximum: 5
                description: User rating
              icon:
                type: string
                description: Icon identifier
              features:
                type: array
                items:
                  type: string
                description: List of key features
              requirements:
                type: object
                properties:
                  cpu:
                    type: number
                    description: Required CPU cores
                  memory:
                    type: number
                    description: Required memory in GB
                  storage:
                    type: number
                    description: Required storage in GB
                required:
                  - cpu
                  - memory
                  - storage
                description: Resource requirements
              configuration:
                type: array
                items:
                  oneOf:
                    - type: object
                      properties:
                        name:
                          type: string
                          description: Configuration field name
                        type:
                          type: string
                          enum:
                            - string
                          description: String input type
                        required:
                          type: boolean
                          description: Whether this field is required
                        default:
                          type: string
                          description: Default value if any
                      required:
                        - name
                        - type
                        - required
                    - type: object
                      properties:
                        name:
                          type: string
                          description: Configuration field name
                        type:
                          type: string
                          enum:
                            - number
                          description: Number input type
                        required:
                          type: boolean
                          description: Whether this field is required
                        default:
                          type: number
                          description: Default value if any
                      required:
                        - name
                        - type
                        - required
                    - type: object
                      properties:
                        name:
                          type: string
                          description: Configuration field name
                        type:
                          type: string
                          enum:
                            - boolean
                          description: Boolean toggle type
                        required:
                          type: boolean
                          description: Whether this field is required
                        default:
                          type: boolean
                          description: Default value if any
                      required:
                        - name
                        - type
                        - required
                    - type: object
                      properties:
                        name:
                          type: string
                          description: Configuration field name
                        type:
                          type: string
                          enum:
                            - select
                          description: Dropdown select type
                        required:
                          type: boolean
                          description: Whether this field is required
                        default:
                          type: string
                          description: Default selected option
                        options:
                          type: array
                          items:
                            type: string
                          description: Available options to select from
                      required:
                        - name
                        - type
                        - required
                        - options
                    - type: object
                      properties:
                        name:
                          type: string
                          description: Configuration field name
                        type:
                          type: string
                          enum:
                            - password
                          description: Password input type
                        required:
                          type: boolean
                          description: Whether this field is required
                        default:
                          type: string
                          description: Default value if any
                      required:
                        - name
                        - type
                        - required
                description: Configuration options
              ingress:
                type: object
                properties:
                  enabled:
                    type: boolean
                    description: Whether ingress is enabled for this app
                  hostname:
                    type: string
                    description: Hostname pattern for the ingress
                  path:
                    type: string
                    description: Path for the ingress
                  tls:
                    type: boolean
                    description: Whether TLS is enabled
                required:
                  - enabled
                  - hostname
                  - path
                  - tls
                description: Ingress configuration if applicable
            required:
              - id
              - name
              - category
              - description
              - installs
              - rating
              - icon
              - features
              - requirements
              - configuration
        object:
          type: string
          enum:
            - list
      required:
        - data
        - object
    AppInstallRequest:
      type: object
      properties:
        appId:
          type: string
          description: ID of the app to install
        namespace:
          type: string
          description: Kubernetes namespace to install into
        configuration:
          type: object
          additionalProperties:
            anyOf:
              - type: string
              - type: number
              - type: boolean
          description: Configuration values
      required:
        - appId
        - namespace
        - configuration
    AppInstallation:
      type: object
      properties:
        id:
          type: string
          description: Installation ID
        appId:
          type: string
          description: App template ID
        name:
          type: string
          description: App name
        namespace:
          type: string
          description: Kubernetes namespace
        status:
          type: string
          enum:
            - pending
            - installing
            - running
            - failed
          description: Installation status
        created:
          type: string
          description: Creation timestamp
        message:
          type: string
          description: Status message or error
        url:
          type: string
          description: Access URL if available
        configuration:
          type: object
          additionalProperties:
            anyOf:
              - type: string
              - type: number
              - type: boolean
          description: Applied configuration
      required:
        - id
        - appId
        - name
        - namespace
        - status
        - created
        - configuration
    AppInstallationList:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                description: Installation ID
              appId:
                type: string
                description: App template ID
              name:
                type: string
                description: App name
              namespace:
                type: string
                description: Kubernetes namespace
              status:
                type: string
                enum:
                  - pending
                  - installing
                  - running
                  - failed
                description: Installation status
              created:
                type: string
                description: Creation timestamp
              message:
                type: string
                description: Status message or error
              url:
                type: string
                description: Access URL if available
              configuration:
                type: object
                additionalProperties:
                  anyOf:
                    - type: string
                    - type: number
                    - type: boolean
                description: Applied configuration
            required:
              - id
              - appId
              - name
              - namespace
              - status
              - created
              - configuration
        object:
          type: string
          enum:
            - list
      required:
        - data
        - object
    Usage:
      type: object
      properties:
        current_period:
          type: object
          properties:
            start_date:
              type: string
              format: date-time
            end_date:
              type: string
              format: date-time
          required:
            - start_date
            - end_date
        metrics:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              value:
                type: number
              unit:
                type: string
              cost:
                type: number
              currency:
                type: string
            required:
              - name
              - value
              - unit
              - cost
              - currency
        total:
          type: object
          properties:
            amount:
              type: number
            currency:
              type: string
          required:
            - amount
            - currency
      required:
        - current_period
        - metrics
        - total
    Invoice:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the invoice
        number:
          type: string
          description: Invoice number (e.g., INV/2025/0001)
        date:
          type: string
          description: Invoice issue date
        dueDate:
          type: string
          description: Payment due date
        status:
          type: string
          enum:
            - paid
            - pending
            - failed
          description: Payment status
        currency:
          type: string
          description: Currency code (e.g., EUR, USD)
        amount:
          type: object
          properties:
            subtotal:
              type: number
              description: Subtotal amount before taxes (in whole currency units)
            tax:
              type: number
              description: Tax amount (in whole currency units)
            total:
              type: number
              description: Total amount including taxes (in whole currency units)
            paid:
              type: number
              description: Amount already paid (in whole currency units)
            due:
              type: number
              description: Amount still due (in whole currency units)
          required:
            - subtotal
            - tax
            - total
            - paid
            - due
          description: Invoice amounts in whole currency units (e.g., euros, dollars)
        customer:
          type: object
          properties:
            id:
              type: string
              description: Customer ID
            name:
              type: string
              description: Customer name
            email:
              type: string
              description: Customer email
            taxId:
              type: string
              nullable: true
              description: Tax identification number
          required:
            - id
            - name
            - email
            - taxId
          description: Customer information
        items:
          type: array
          items:
            type: object
            properties:
              description:
                type: string
                description: Item description
              amount:
                type: number
                description: Item amount in whole currency units
              currency:
                type: string
                description: Item currency
            required:
              - description
              - amount
              - currency
          description: Invoice line items
        downloadUrl:
          type: string
          nullable: true
          description: URL to download the invoice PDF
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Additional invoice metadata
        period:
          type: object
          properties:
            start:
              type: string
              description: Start date of the billing period
            end:
              type: string
              description: End date of the billing period
          required:
            - start
            - end
          description: Billing period covered by this invoice
      required:
        - id
        - number
        - date
        - dueDate
        - status
        - currency
        - amount
        - customer
        - items
        - downloadUrl
    PaymentMethod:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
          enum:
            - card
            - sepa
        last4:
          type: string
        expMonth:
          type: number
        expYear:
          type: number
        brand:
          type: string
        isDefault:
          type: boolean
      required:
        - id
        - type
        - last4
        - isDefault
    CreatePaymentMethod:
      type: object
      properties:
        type:
          type: string
          enum:
            - card
            - sepa
        token:
          type: string
        setDefault:
          type: boolean
      required:
        - type
        - token
    UpdateSubscription:
      type: object
      properties:
        planId:
          type: string
        quantity:
          type: number
          default: 1
      required:
        - planId
    Order:
      type: object
      properties:
        id:
          type: string
          description: Order ID
        date:
          type: string
          description: Order date
        status:
          type: string
          description: Order status
        amount:
          type: number
          description: Order amount in whole currency units
        currency:
          type: string
          description: Currency code (e.g., EUR, USD)
        items:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                description: Product name
              quantity:
                type: number
                description: Quantity ordered
              unitPrice:
                type: number
                description: Unit price in whole currency units
              totalPrice:
                type: number
                description: Total price in whole currency units
            required:
              - name
              - quantity
              - unitPrice
              - totalPrice
          description: Order items
        subscription:
          type: object
          properties:
            planId:
              type: string
              description: Subscription plan ID
            planName:
              type: string
              description: Subscription plan name
            startDate:
              type: string
              description: Subscription start date
            endDate:
              type: string
              description: Subscription end date
            status:
              type: string
              description: Subscription status
          required:
            - planId
            - planName
            - status
          description: Subscription details if this order is for a subscription
      required:
        - id
        - date
        - status
        - amount
        - currency
        - items
    OrderHistory:
      type: object
      properties:
        orders:
          type: array
          items:
            $ref: "#/components/schemas/Order"
          description: List of orders
        currentSubscription:
          type: object
          nullable: true
          properties:
            planId:
              type: string
              description: Current subscription plan ID
            planName:
              type: string
              description: Current subscription plan name
            startDate:
              type: string
              description: Subscription start date
            endDate:
              type: string
              description: Subscription end date
            status:
              type: string
              description: Subscription status
            quantity:
              type: number
              default: 1
              description: Number of seats/licenses
            renewalDate:
              type: string
              description: Next renewal date
          required:
            - planId
            - planName
            - startDate
            - status
          description: Current active subscription, if any
      required:
        - orders
        - currentSubscription
    ApiError:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: An error occurred while processing the request
        code:
          type: string
          description: Error code
          example: PROCESSING_ERROR
        details:
          nullable: true
          description: Additional error details
          example:
            field: document
            reason: Invalid format
      required:
        - error
        - code
    OCRMethod:
      type: string
      enum:
        - tesseract
        - easyocr
        - ocrmac
        - rapidocr
        - tesserocr
      default: easyocr
      description: "OCR method to use: tesseract, easyocr, ocrmac, rapidocr, or tesserocr"
      example: easyocr
    DocumentURLChunk:
      type: object
      properties:
        url:
          type: string
          format: uri
          description: URL to the document
          example: https://example.com/document.pdf
        type:
          type: string
          enum:
            - document
          description: Type of the document
          example: document
      required:
        - url
        - type
    ImageURLChunk:
      type: object
      properties:
        url:
          type: string
          format: uri
          description: URL to the image
          example: https://example.com/image.jpg
        type:
          type: string
          enum:
            - image
          description: Type of the document
          example: image
      required:
        - url
        - type
    OCRRequest:
      type: object
      properties:
        model:
          type: string
          nullable: true
          description: Model to use for OCR
          example: docling-v1
        document:
          anyOf:
            - $ref: "#/components/schemas/DocumentURLChunk"
            - $ref: "#/components/schemas/ImageURLChunk"
          description: Document to run OCR on
        async:
          type: boolean
          default: false
          description: Process the document asynchronously
          example: true
        options:
          type: object
          properties:
            tableMode:
              type: string
              enum:
                - accurate
                - fast
              default: accurate
              description: "Mode for table extraction: accurate (slower but better), fast
                (quicker but less precise), or none (no table extraction)"
              example: accurate
            ocrMethod:
              type: string
              enum:
                - tesseract
                - easyocr
                - ocrmac
                - rapidocr
                - tesserocr
              default: easyocr
              description: "OCR method to use: tesseract, easyocr, ocrmac, rapidocr, or
                tesserocr"
              example: easyocr
            doOcr:
              type: boolean
              default: true
              description: Whether to perform OCR on the document
              example: true
            doTableStructure:
              type: boolean
              default: true
              description: Whether to extract table structure
              example: true
            inputFormat:
              type: array
              items:
                type: string
                enum:
                  - pdf
                  - html
                  - docx
                  - pptx
              default:
                - pdf
              description: Input formats to generate
              example:
                - pdf
            outputFormat:
              type: string
              enum:
                - md
                - json
            includeImages:
              type: boolean
              default: false
              description: Whether to include images in the output (base64 encoded)
              example: false
          default:
            tableMode: accurate
            ocrMethod: easyocr
            doOcr: true
            doTableStructure: true
            inputFormat:
              - pdf
            outputFormat: md
            includeImages: false
          required:
            - outputFormat
          description: Advanced OCR processing options
      required:
        - document
    OCRUsageInfo:
      type: object
      properties:
        pages:
          type: integer
          minimum: 0
          description: Number of pages processed
          example: 1
        characters:
          type: integer
          minimum: 0
          description: Number of characters processed
          example: 2492
      required:
        - pages
        - characters
      description: Usage statistics for the OCR request
    OCRMetadata:
      type: object
      properties:
        filename:
          type: string
          description: Original filename
          example: document
        pageCount:
          type: integer
          minimum: 0
          description: Total number of pages in the document
          example: 1
        fileType:
          type: string
          description: MIME type of the document
          example: application/pdf
        processingTime:
          type: integer
          minimum: 0
          description: Processing time in milliseconds
          example: 7787
      required:
        - filename
        - pageCount
        - fileType
        - processingTime
      description: Metadata about the processed document
    OCRResponse:
      type: object
      properties:
        usage:
          $ref: "#/components/schemas/OCRUsageInfo"
        content:
          type: string
          description: The extracted text content in markdown format
          example: >-
            # Document Title


            This is the content of the document with **bold text** and *italic
            text*.
        metadata:
          $ref: "#/components/schemas/OCRMetadata"
      required:
        - usage
        - content
        - metadata
    AsyncOCRResponse:
      type: object
      properties:
        taskId:
          type: string
          description: Task ID for the asynchronous OCR request
          example: d11234-5678-9101-1121
        status:
          type: string
          enum:
            - pending
            - processing
            - completed
            - failed
          description: Current status of the OCR job
          example: pending
        resultUrl:
          type: string
          description: URL to get the result of the task
          example: /v1/ocr/result/d11234-5678-9101-1121
      required:
        - taskId
        - status
        - resultUrl
    EmbeddingRequest:
      type: object
      properties:
        model:
          type: string
          default: intfloat/multilingual-e5-large-instruct
          description: ID of the model to use. Defaults to
            intfloat/multilingual-e5-large-instruct which is a fast and
            versatile model with good language understanding of European
            languages. Supports 100+ languages.
        input:
          anyOf:
            - type: string
            - type: array
              items:
                type: string
          description: The input text to generate embeddings for
        encoding_format:
          type: string
          enum:
            - float
            - base64
          default: float
          description: The format of the returned embeddings
        dimensions:
          type: number
          description: The number of dimensions the resulting output embeddings should
            have. If not specified, the model's default dimension size will be
            used (1024 for intfloat/multilingual-e5-large-instruct).
        user:
          type: string
          description: A unique identifier representing your end-user. This helps with
            tracking and abuse prevention. If not provided, the API key owner
            will be used.
      required:
        - input
    EmbeddingResponse:
      type: object
      properties:
        object:
          type: string
          enum:
            - list
        data:
          type: array
          items:
            type: object
            properties:
              object:
                type: string
                enum:
                  - embedding
              embedding:
                type: array
                items:
                  type: number
              index:
                type: number
            required:
              - object
              - embedding
              - index
        model:
          type: string
        usage:
          type: object
          properties:
            prompt_tokens:
              type: number
            total_tokens:
              type: number
            co2_grams:
              type: number
              description: CO2 emissions in grams
          required:
            - prompt_tokens
            - total_tokens
      required:
        - object
        - data
        - model
        - usage
    RerankRequest:
      type: object
      properties:
        model:
          type: string
          default: BAAI/bge-reranker-v2-m3
          description: ID of the model to use. Defaults to BAAI/bge-reranker-v2-m3, a
            high-quality multilingual reranking model.
        query:
          type: string
          description: The search query to rank documents against
        documents:
          type: array
          items:
            type: string
          description: The documents to rerank
        top_n:
          type: number
          default: 3
          description: The number of documents to return
        return_documents:
          type: boolean
          default: true
          description: Whether to return the document text in the response
        user:
          type: string
          description: A unique identifier representing your end-user
      required:
        - query
        - documents
    RerankResponse:
      type: object
      properties:
        object:
          type: string
          enum:
            - list
        data:
          type: array
          items:
            type: object
            properties:
              object:
                type: string
                enum:
                  - reranked_document
              document:
                type: string
              index:
                type: number
              relevance_score:
                type: number
            required:
              - object
              - index
              - relevance_score
        model:
          type: string
        usage:
          type: object
          properties:
            prompt_tokens:
              type: number
            total_tokens:
              type: number
            co2_grams:
              type: number
              description: CO2 emissions in grams
          required:
            - prompt_tokens
            - total_tokens
      required:
        - object
        - data
        - model
        - usage
    TranscriptionResponse:
      type: object
      properties:
        text:
          type: string
          description: The transcribed text
        usage:
          type: object
          properties:
            prompt_tokens:
              type: number
            completion_tokens:
              type: number
            total_tokens:
              type: number
            co2_grams:
              type: number
              description: CO2 emissions in grams
      required:
        - text
  parameters: {}
paths:
  /v1/api-keys:
    get:
      summary: List all API keys
      description: |
        Lists all API keys for the authenticated user's organization.

        ## Using the CLI

        You can also manage API keys using our CLI tool:
        ```
        # Login first (if you haven't already)
        npx berget auth login

        # List all API keys
        npx berget api-keys list

        # Create a new API key
        npx berget api-keys create --name my-api-key
        ```
      tags:
        - API Keys
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of API keys
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyListResponse"
        "401":
          description: Unauthorized - Authentication token is missing or invalid
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Authentication required
                  code:
                    type: string
                    example: AUTH_REQUIRED
        "403":
          description: Forbidden - User does not have permission to list API keys
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Insufficient permissions
                  code:
                    type: string
                    example: INSUFFICIENT_PERMISSIONS
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch API keys
                  code:
                    type: string
                    example: API_KEYS_FETCH_FAILED
    post:
      summary: Create a new API key
      description: >
        Creates a new API key for the authenticated user's organization. The
        full API key is only returned once at creation time.


        ## Using the CLI


        Creating an API key is easier with our CLI tool:

        ```

        # Login first (if you haven't already)

        npx berget auth login


        # Create a new API key

        npx berget api-keys create --name my-api-key

        ```
      tags:
        - API Keys
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateApiKey"
      responses:
        "201":
          description: API key created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateApiKeyResponse"
        "400":
          description: Bad Request - Invalid input parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Validation failed
                  code:
                    type: string
                    example: VALIDATION_ERROR
                  details:
                    type: object
                    properties:
                      errors:
                        type: array
                        items:
                          type: object
                          properties:
                            path:
                              type: string
                            message:
                              type: string
                            code:
                              type: string
        "401":
          description: Unauthorized - Authentication token is missing or invalid
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Authentication required
                  code:
                    type: string
                    example: AUTH_REQUIRED
        "403":
          description: Forbidden - User does not have permission to create API keys
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Insufficient permissions
                  code:
                    type: string
                    example: INSUFFICIENT_PERMISSIONS
        "429":
          description: Too Many Requests - API key creation rate limit exceeded
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Too many API key creation attempts
                  code:
                    type: string
                    example: RATE_LIMIT_EXCEEDED
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to create API key
                  code:
                    type: string
                    example: API_KEY_CREATION_FAILED
  /v1/api-keys/{id}:
    delete:
      summary: Delete an API key
      description: Permanently deletes an API key
      tags:
        - API Keys
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: API key ID
      responses:
        "204":
          description: API key deleted successfully
        "400":
          description: Bad Request - Invalid API key ID format
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid API key ID format
                  code:
                    type: string
                    example: INVALID_ID_FORMAT
        "401":
          description: Unauthorized - Authentication token is missing or invalid
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Authentication required
                  code:
                    type: string
                    example: AUTH_REQUIRED
        "403":
          description: Forbidden - User does not have permission to delete this API key
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Insufficient permissions to delete this API key
                  code:
                    type: string
                    example: INSUFFICIENT_PERMISSIONS
        "404":
          description: API key not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: API key not found
                  code:
                    type: string
                    example: API_KEY_NOT_FOUND
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to delete API key
                  code:
                    type: string
                    example: API_KEY_DELETION_FAILED
  /v1/api-keys/{id}/usage:
    get:
      summary: Get API key usage statistics
      description: >
        Returns usage statistics for a specific API key including request count,
        daily breakdown, model-specific usage, and token consumption.


        ## Using the CLI


        You can also view API key usage using our CLI tool:

        ```

        # Login first (if you haven't already)

        npx berget auth login


        # View usage for all API keys

        npx berget usage

        ```
      tags:
        - API Keys
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: API key ID
        - in: query
          name: start_date
          schema:
            type: string
          description: Start date in YYYY-MM-DD format
        - in: query
          name: end_date
          schema:
            type: string
          description: End date in YYYY-MM-DD format
      responses:
        "200":
          description: API key usage statistics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiKeyUsageResponse"
        "400":
          description: Bad Request - Invalid parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid date format. Use YYYY-MM-DD
                  code:
                    type: string
                    example: INVALID_DATE_FORMAT
                  details:
                    type: object
                    properties:
                      param:
                        type: string
                        example: start_date
        "401":
          description: Unauthorized - Authentication token is missing or invalid
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Authentication required
                  code:
                    type: string
                    example: AUTH_REQUIRED
        "403":
          description: Forbidden - User does not have permission to view this API key's
            usage
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Insufficient permissions to view this API key's usage
                  code:
                    type: string
                    example: INSUFFICIENT_PERMISSIONS
        "404":
          description: API key not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: API key not found
                  code:
                    type: string
                    example: API_KEY_NOT_FOUND
        "416":
          description: Range Not Satisfiable - Date range too large or invalid
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Date range too large. Maximum range is 90 days
                  code:
                    type: string
                    example: DATE_RANGE_TOO_LARGE
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch API key usage
                  code:
                    type: string
                    example: API_KEY_USAGE_FETCH_FAILED
  /v1/apps/templates:
    get:
      summary: List app templates
      description: Retrieves a list of all available application templates that can be
        installed in your cluster
      tags:
        - Apps
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of app templates
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppTemplateList"
        "401":
          description: Unauthorized
        "500":
          description: Server error
  /v1/apps/templates/{appId}:
    get:
      summary: Get app template details
      description: Retrieves detailed information about a specific app template
      tags:
        - Apps
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: appId
          required: true
          schema:
            type: string
          description: App template ID
      responses:
        "200":
          description: App template details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppTemplate"
        "401":
          description: Unauthorized
        "404":
          description: App template not found
        "500":
          description: Server error
  /v1/apps/installations:
    get:
      summary: List app installations
      description: Retrieves a list of all installed applications in your clusters
      tags:
        - Apps
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of app installations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppInstallationList"
        "401":
          description: Unauthorized
        "500":
          description: Server error
    post:
      summary: Install an app
      description: Installs an application from a template into your cluster
      tags:
        - Apps
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AppInstallRequest"
      responses:
        "201":
          description: App installation initiated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppInstallation"
        "400":
          description: Invalid request
        "401":
          description: Unauthorized
        "404":
          description: App template not found
        "500":
          description: Server error
  /v1/apps/installations/{installationId}:
    get:
      summary: Get installation details
      description: Retrieves detailed information about a specific app installation
      tags:
        - Apps
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: installationId
          required: true
          schema:
            type: string
          description: Installation ID
      responses:
        "200":
          description: Installation details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppInstallation"
        "401":
          description: Unauthorized
        "404":
          description: Installation not found
        "500":
          description: Server error
    delete:
      summary: Uninstall an app
      description: Removes an installed application from your cluster
      tags:
        - Apps
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: installationId
          required: true
          schema:
            type: string
          description: Installation ID
      responses:
        "204":
          description: App uninstallation initiated
        "401":
          description: Unauthorized
        "404":
          description: Installation not found
        "500":
          description: Server error
  /v1/auth/register:
    post:
      summary: Register a new user
      description: |
        Create a new user account with company details and subscription plans.

        This endpoint handles the complete registration process including:
        - User account creation
        - Company registration
        - Subscription setup

        The registration process validates:
        - Email uniqueness
        - VAT number (if provided)
        - Product plan availability
        - Terms acceptance

        After registration, the user receives a magic link via email to complete
        the authentication process without needing a password.
      tags:
        - Auth
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Registration"
            example:
              user:
                name: John Doe
                email: john.doe@example.com
                password: SecurePassword123!
                language: sv_SE
                timezone: Europe/Stockholm
              company:
                name: Example Company AB
              termsAccepted: true
      responses:
        "201":
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationResponse"
              example:
                user:
                  id: user-123
                  email: john.doe@example.com
                  name: John Doe
                  companyId: 456
                  role: admin
                  company:
                    id: 456
                    name: Example Company AB
        "400":
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationError"
        "402":
          description: Payment required
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationError"
        "409":
          description: Email already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationError"
        "429":
          description: Too many registration attempts
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: Too many registration attempts, please try again later
                      type:
                        type: string
                        example: rate_limit_exceeded
                      code:
                        type: string
                        example: REGISTRATION_RATE_LIMIT_EXCEEDED
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistrationError"
    get:
      summary: OAuth registration
      description: >
        Initiates OAuth registration flow via Keycloak.


        This endpoint redirects the user to Keycloak's registration page.

        After registration, the user will be redirected back to our API,

        which will set authentication cookies and redirect to the specified URL.


        If the user already has an Odoo account, they will be redirected to the
        frontend.

        If not, they will be redirected to the specified redirectUrl.
      tags:
        - Auth
      security: []
      parameters:
        - in: query
          name: redirectUrl
          schema:
            type: string
          required: true
          description: URL to redirect to after successful registration if no Odoo account
            exists
      responses:
        "302":
          description: Redirects to Keycloak for registration
        "400":
          description: Missing redirectUrl parameter
        "429":
          description: Too many registration attempts, please try again later
  /v1/auth/login:
    get:
      summary: OAuth login
      description: |
        Initiates OAuth login flow via Keycloak.

        ## CLI Authentication

        For a simpler experience, you can use our CLI tool to authenticate:
        ```
        npx berget auth login
        ```

        After logging in, you can create an API key with:
        ```
        npx berget api-keys create --name my-api-key
        ```
      tags:
        - Auth
      security: []
      parameters:
        - in: query
          name: redirect_uri
          schema:
            type: string
          required: false
          description: URL to redirect to after successful login
        - in: query
          name: response_type
          schema:
            type: string
            enum:
              - redirect
              - json
          required: false
          description: How to return the token after successful login (default is redirect)
      responses:
        "302":
          description: Redirects to Keycloak for login
        "429":
          description: Too many login attempts, please try again later
  /v1/auth/callback:
    get:
      summary: OAuth callback
      description: Handles login callback and exchanges token and sets cookies
      tags:
        - Auth
      security: []
      parameters:
        - in: query
          name: code
          required: true
          schema:
            type: string
        - in: query
          name: state
          required: true
          schema:
            type: string
      responses:
        "302":
          description: Redirects to frontend
  /v1/auth/register/callback:
    get:
      summary: OAuth registration callback
      description: Handles registration callback, exchanges token, sets cookies, and
        checks for Odoo account
      tags:
        - Auth
      security: []
      parameters:
        - in: query
          name: code
          required: true
          schema:
            type: string
        - in: query
          name: state
          required: true
          schema:
            type: string
      responses:
        "302":
          description: Redirects to frontend or specified redirectUrl
          content:
            text/html:
              schema:
                type: string
              examples:
                success:
                  summary: Successful registration
                  value: Redirecting to frontend...
                registration_failed:
                  summary: Registration failed
                  description: Registration failed due to an error
                  value: Registration failed. Please try again or contact support.
                user_already_exists:
                  summary: User already exists
                  description: User already exists in the system
                  value: Ett konto med denna e-postadress finns redan. Vänligen kontakta
                    kundtjänst för hjälp.
  /v1/auth/status:
    get:
      summary: Authentication status
      description: Returns the current authentication status and user information if
        authenticated
      tags:
        - Auth
      security:
        - BearerAuth: []
        - CookieAuth: []
      responses:
        "200":
          description: Authentication status
          content:
            application/json:
              schema:
                type: object
                properties:
                  authenticated:
                    type: boolean
        "401":
          description: Not authenticated
  /v1/auth/logout:
    get:
      summary: Logout
      description: |
        Logs the user out from both the application and Keycloak.

        This endpoint:
        1. Clears all authentication cookies
        2. Invalidates the session in Keycloak
        3. Redirects the user to the specified redirect URI or home page
      tags:
        - Auth
      parameters:
        - in: query
          name: redirect_uri
          schema:
            type: string
          required: false
          description: URL to redirect to after logout (must be a valid URL)
      responses:
        "302":
          description: Redirects to the specified URL or home page after logout
  /v1/auth/device:
    post:
      summary: Initiate device authorization flow
      description: >
        Initiates the device authorization flow, returning a device code and
        user verification URL.


        ## Using the CLI


        The recommended way to authenticate is through our CLI tool:

        ```

        npx berget auth login

        ```


        This handles the device flow automatically and provides a better user
        experience.
      tags:
        - Auth
      security: []
      responses:
        "200":
          description: Device authorization initiated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeviceAuthInitResponse"
        "429":
          description: Too many requests, please try again later
  /v1/auth/device/token:
    post:
      summary: Poll for device token
      description: >
        Polls for the status of a device authorization flow. The client should
        poll this endpoint

        until it receives a token or an error.


        ## Using the CLI


        The recommended way to authenticate is through our CLI tool:

        ```

        npx berget auth login

        ```


        This handles the polling automatically and provides a better user
        experience.


        ## Troubleshooting


        - If you receive a 400 error, the device code may be invalid or expired

        - If you receive a 429 error, you're polling too frequently

        - If you receive a 500 error, there may be an issue with the
        authentication service
      tags:
        - Auth
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeviceAuthRequest"
      responses:
        "200":
          description: Token returned or pending status
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: "#/components/schemas/DeviceAuthPendingResponse"
                  - $ref: "#/components/schemas/DeviceAuthTokenResponse"
                discriminator:
                  propertyName: status
        "400":
          description: Invalid device code or expired token
        "429":
          description: Polling too frequently
        "500":
          description: Server error during authentication
  /v1/auth/refresh:
    post:
      summary: Refresh access token
      description: >
        Refreshes an access token using a refresh token. This endpoint can be
        used to obtain a new

        access token when the current one expires.


        ## Using the CLI


        The CLI tool handles token refresh automatically:

        ```

        # The CLI will refresh tokens as needed

        npx berget api-keys list

        ```
      tags:
        - Auth
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenRequest"
      responses:
        "200":
          description: New access and refresh tokens
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefreshTokenResponse"
        "401":
          description: Invalid or expired refresh token
        "429":
          description: Too many refresh attempts, please try again later
  /v1/billing/invoices:
    get:
      summary: List invoices
      description: >
        Retrieves all invoices for the authenticated user.


        ## Response Format


        - All monetary amounts are returned in whole currency units (e.g.,
        euros, dollars)

        - The `amount` object contains:
          - `subtotal`: Amount before taxes
          - `tax`: Tax amount
          - `total`: Total amount including taxes
          - `paid`: Amount already paid
          - `due`: Amount still due
        - Invoice status can be `paid`, `pending`, or `failed`

        - Line items show individual charges and taxes
      tags:
        - Billing
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of invoices
          content:
            application/json:
              schema:
                type: object
                properties:
                  invoices:
                    type: array
                    items:
                      $ref: "#/components/schemas/Invoice"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/billing/invoices/{id}:
    get:
      summary: Get invoice details
      description: >
        Retrieves details for a specific invoice.


        ## Response Format


        - All monetary amounts are returned in whole currency units (e.g.,
        euros, dollars)

        - The `amount` object contains:
          - `subtotal`: Amount before taxes
          - `tax`: Tax amount
          - `total`: Total amount including taxes
          - `paid`: Amount already paid
          - `due`: Amount still due
        - Invoice status can be `paid`, `pending`, or `failed`

        - The `items` array contains line items with descriptions and amounts

        - If available, `downloadUrl` provides a link to download the invoice
        PDF
      tags:
        - Billing
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: The invoice ID
      responses:
        "200":
          description: Invoice details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Invoice"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Invoice not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/billing/payment-methods:
    get:
      summary: List payment methods
      description: Retrieves all payment methods for the authenticated user
      tags:
        - Billing
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of payment methods
          content:
            application/json:
              schema:
                type: object
                properties:
                  paymentMethods:
                    type: array
                    items:
                      $ref: "#/components/schemas/PaymentMethod"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      summary: Add payment method
      description: Adds a new payment method for the authenticated user
      tags:
        - Billing
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePaymentMethod"
      responses:
        "201":
          description: Payment method added
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentMethod"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/billing/payment-methods/{id}:
    delete:
      summary: Remove payment method
      description: Removes a payment method for the authenticated user
      tags:
        - Billing
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Payment method removed
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Payment method not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/billing/subscription:
    put:
      summary: Update subscription
      description: Updates the subscription plan for the authenticated user
      tags:
        - Billing
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateSubscription"
      responses:
        "200":
          description: Subscription updated
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/billing/orders:
    get:
      summary: Get order history and current subscription
      description: >
        Retrieves order history and current subscription details for the
        authenticated user.


        ## Response Format


        - `orders`: Array of past orders with details

        - `currentSubscription`: Details about the current active subscription
        (if any)
          - Plan information
          - Start and end dates
          - Status
          - Quantity (number of seats/licenses)
          - Next renewal date
      tags:
        - Billing
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Order history and current subscription
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderHistory"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/chat/completions:
    post:
      summary: Create a chat completion
      description: >
        Creates a model response for the given chat conversation.


        This endpoint is compatible with OpenAI's chat completions API, making
        it easy to switch between providers.


        ## Quick Start


        1. Get an API key from the dashboard or `/v1/api-keys` endpoint

        2. Make a simple request:


        ```json

        {
          "model": "gpt-oss",
          "messages": [
            {"role": "user", "content": "Knock knock?"}
          ]
        }

        ```


        That's it! The API will use default values for temperature (0.7) and
        other parameters.


        ## More Examples


        ### Basic conversation with system prompt:

        ```json

        {
          "model": "gpt-oss",
          "messages": [
            {"role": "system", "content": "Du är en hjälpsam assistent som svarar på svenska."},
            {"role": "user", "content": "Förklara kvantfysik på ett enkelt sätt"}
          ],
          "temperature": 0.7,
          "max_tokens": 500
        }

        ```


        ### Creative writing with higher temperature:

        ```json

        {
          "model": "magistral",
          "messages": [
            {"role": "system", "content": "You are a creative writing assistant."},
            {"role": "user", "content": "Write a short story about a robot learning to paint"}
          ],
          "temperature": 1.2,
          "max_tokens": 800
        }

        ```


        ### Code generation with precise output:

        ```json

        {
          "model": "gpt-oss",
          "messages": [
            {"role": "system", "content": "You are a senior software developer. Write clean, well-documented code."},
            {"role": "user", "content": "Create a Python function to calculate fibonacci numbers with memoization"}
          ],
          "temperature": 0.1,
          "max_tokens": 600
        }

        ```


        ## Structured Output


        To get structured JSON output, use the `response_format` parameter:


        ### Simple JSON structure:

        ```json

        {
          "model": "llama-70b",
          "messages": [
            {"role": "system", "content": "Du svarar alltid med strukturerad JSON."},
            {"role": "user", "content": "Skapa en lista med 3 svenska städer och deras befolkning"}
          ],
          "response_format": {
            "type": "json_object",
            "schema": {
              "type": "object",
              "properties": {
                "städer": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "namn": { "type": "string" },
                      "befolkning": { "type": "number" },
                      "län": { "type": "string" }
                    }
                  }
                }
              }
            }
          }
        }

        ```


        ### Complex data extraction:

        ```json

        {
          "model": "magistral",
          "messages": [
            {"role": "system", "content": "Extract structured information from text."},
            {"role": "user", "content": "John Smith works at Acme Corp as a Software Engineer. He can be reached at john@acme.com or +1-555-0123. He lives in San Francisco, CA."}
          ],
          "response_format": {
            "type": "json_object",
            "schema": {
              "type": "object",
              "properties": {
                "person": {
                  "type": "object",
                  "properties": {
                    "name": { "type": "string" },
                    "company": { "type": "string" },
                    "title": { "type": "string" },
                    "email": { "type": "string" },
                    "phone": { "type": "string" },
                    "location": { "type": "string" }
                  }
                }
              }
            }
          }
        }

        ```


        ## Function Calling and Tools


        You can define functions that the model can call:


        ### Weather lookup example:

        ```json

        {
          "model": "llama-70b",
          "messages": [
            {"role": "system", "content": "Du är en hjälpsam assistent med tillgång till väderdata."},
            {"role": "user", "content": "Hur är vädret i Stockholm just nu?"}
          ],
          "tools": [
            {
              "type": "function",
              "function": {
                "name": "get_weather",
                "description": "Hämta aktuell väderinformation för en plats",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "location": {
                      "type": "string",
                      "description": "Stad och land, t.ex. Stockholm, Sverige"
                    },
                    "unit": {
                      "type": "string",
                      "enum": ["celsius", "fahrenheit"],
                      "description": "Temperaturenhet"
                    }
                  },
                  "required": ["location"]
                }
              }
            }
          ]
        }

        ```


        ### Database query example:

        ```json

        {
          "model": "magistral",
          "messages": [
            {"role": "system", "content": "You are a data analyst with access to customer database."},
            {"role": "user", "content": "Show me sales data for Q4 2023"}
          ],
          "tools": [
            {
              "type": "function",
              "function": {
                "name": "query_sales_data",
                "description": "Query sales database for specific time periods",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "start_date": {
                      "type": "string",
                      "description": "Start date in YYYY-MM-DD format"
                    },
                    "end_date": {
                      "type": "string",
                      "description": "End date in YYYY-MM-DD format"
                    },
                    "metrics": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "Metrics to include: revenue, units_sold, customers"
                    }
                  },
                  "required": ["start_date", "end_date"]
                }
              }
            }
          ]
        }

        ```


        The model will respond with tool calls that your application can
        execute:


        ```json

        {
          "id": "chatcmpl-123",
          "object": "chat.completion",
          "created": 1677858242,
          "model": "magistral",
          "choices": [{
            "message": {
              "role": "assistant",
              "content": null,
              "tool_calls": [
                {
                  "id": "call_abc123",
                  "type": "function",
                  "function": {
                    "name": "get_weather",
                    "arguments": "{\"location\":\"Stockholm\",\"unit\":\"celsius\"}"
                  }
                }
              ]
            },
            "finish_reason": "tool_calls",
            "index": 0
          }]
        }

        ```


        You can then execute the function and send the result back to the model:


        ```json

        {
          "model": "magistral",
          "messages": [
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": "What's the weather like in Stockholm?"},
            {
              "role": "assistant",
              "content": null,
              "tool_calls": [
                {
                  "id": "call_abc123",
                  "type": "function",
                  "function": {
                    "name": "get_weather",
                    "arguments": "{\"location\":\"Stockholm\",\"unit\":\"celsius\"}"
                  }
                }
              ]
            },
            {
              "role": "tool",
              "content": "{\"temperature\": 15, \"unit\": \"celsius\", \"description\": \"Partly cloudy\"}",
              "tool_call_id": "call_abc123"
            }
          ]
        }

        ```


        3. Process the response which contains the assistant's reply


        ## Images


        You can include images in your messages by using the array format for
        content:


        ### Basic image analysis:

        ```json

        {
          "model": "gpt-oss",
          "messages": [
            {
              "role": "user",
              "content": [
                {
                  "type": "text",
                  "text": "Vad ser du på den här bilden? Beskriv detaljerat."
                },
                {
                  "type": "image_url",
                  "image_url": {
                    "url": "https://example.com/swedish-landscape.jpg",
                    "detail": "high"
                  }
                }
              ]
            }
          ]
        }

        ```


        ### Document analysis:

        ```json

        {
          "model": "magistral",
          "messages": [
            {
              "role": "system",
              "content": "You are an expert at analyzing documents and extracting key information."
            },
            {
              "role": "user",
              "content": [
                {
                  "type": "text",
                  "text": "Extract all the key information from this invoice and format it as JSON"
                },
                {
                  "type": "image_url",
                  "image_url": {
                    "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD...",
                    "detail": "high"
                  }
                }
              ]
            }
          ],
          "response_format": {
            "type": "json_object"
          }
        }

        ```


        The API will automatically convert image URLs to base64 data URLs before
        sending to the model.

        You can also directly provide base64-encoded images using the data URL
        format:


        ```json

        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAUDBAQEAwUE...",
            "detail": "auto"
          }
        }

        ```


        The `detail` parameter can be set to:

        - `"high"`: More detailed image analysis but costs more tokens

        - `"low"`: Less detailed analysis, uses fewer tokens

        - `"auto"`: Let the model decide based on the image


        ## Streaming


        To receive a streaming response, set `stream: true` in your request:


        ### Basic streaming:

        ```json

        {
          "model": "gpt-oss",
          "messages": [
            {"role": "system", "content": "Du är en kreativ berättare."},
            {"role": "user", "content": "Skriv en kort saga om en svensk troll som lär sig programmera"}
          ],
          "stream": true,
          "temperature": 0.8
        }

        ```


        ### Long-form content streaming:

        ```json

        {
          "model": "magistral",
          "messages": [
            {"role": "system", "content": "You are a technical writer creating comprehensive documentation."},
            {"role": "user", "content": "Write a complete guide on setting up a Node.js microservice with Docker, including best practices"}
          ],
          "stream": true,
          "max_tokens": 2000,
          "temperature": 0.3
        }

        ```


        The response will be a stream of server-sent events (SSE), with each
        event containing a chunk of the response.
      tags:
        - Chat
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatCompletionRequest"
            examples:
              basic_example:
                summary: Tell me a joke
                description: A simple question with default values
                value:
                  model: gpt-oss
                  messages:
                    - role: user
                      content: Knock knock?
              conversation_with_system:
                summary: Konversation med systemprompt
                description: Strukturerad konversation på svenska med systemprompt
                value:
                  model: gpt-oss
                  messages:
                    - role: system
                      content: Du är en hjälpsam assistent som svarar på svenska.
                    - role: user
                      content: Förklara kvantfysik på ett enkelt sätt
                  temperature: 0.7
                  max_tokens: 500
              creative_writing:
                summary: Kreativt skrivande
                description: Kreativ berättelse med högre temperatur
                value:
                  model: magistral
                  messages:
                    - role: system
                      content: You are a creative writing assistant.
                    - role: user
                      content: Write a short story about a robot learning to paint
                  temperature: 1.2
                  max_tokens: 800
              code_generation:
                summary: Kodgenerering
                description: Precis kodgenerering med låg temperatur
                value:
                  model: gpt-oss
                  messages:
                    - role: system
                      content: You are a senior software developer. Write clean, well-documented code.
                    - role: user
                      content: Create a Python function to calculate fibonacci numbers with
                        memoization
                  temperature: 0.1
                  max_tokens: 600
              structured_json_swedish:
                summary: Strukturerad JSON på svenska
                description: JSON-output med svenska städer
                value:
                  model: gpt-oss
                  messages:
                    - role: system
                      content: Du svarar alltid med strukturerad JSON.
                    - role: user
                      content: Skapa en lista med 3 svenska städer och deras befolkning
                  response_format:
                    type: json_object
                    schema:
                      type: object
                      properties:
                        städer:
                          type: array
                          items:
                            type: object
                            properties:
                              namn:
                                type: string
                              befolkning:
                                type: number
                              län:
                                type: string
              data_extraction:
                summary: Dataextraktion
                description: Komplex dataextraktion till JSON
                value:
                  model: magistral
                  messages:
                    - role: system
                      content: Extract structured information from text.
                    - role: user
                      content: John Smith works at Acme Corp as a Software Engineer. He can be reached
                        at john@acme.com or +1-555-0123. He lives in San
                        Francisco, CA.
                  response_format:
                    type: json_object
                    schema:
                      type: object
                      properties:
                        person:
                          type: object
                          properties:
                            name:
                              type: string
                            company:
                              type: string
                            title:
                              type: string
                            email:
                              type: string
                            phone:
                              type: string
                            location:
                              type: string
              weather_tool_llama:
                summary: Väderverktyg med Llama-70B
                description: Funktionsanrop för väder med Llama-70B (bäst för tools)
                value:
                  model: meta-llama/Llama-3.1-70B-Instruct
                  messages:
                    - role: system
                      content: Du är en hjälpsam assistent med tillgång till väderdata.
                    - role: user
                      content: Hur är vädret i Stockholm just nu?
                  tools:
                    - type: function
                      function:
                        name: get_weather
                        description: Hämta aktuell väderinformation för en plats
                        parameters:
                          type: object
                          properties:
                            location:
                              type: string
                              description: Stad och land, t.ex. Stockholm, Sverige
                            unit:
                              type: string
                              enum:
                                - celsius
                                - fahrenheit
                              description: Temperaturenhet
                          required:
                            - location
                  tool_choice: auto
              database_query_llama:
                summary: Databasförfrågan med Llama-70B
                description: Avancerat funktionsanrop för databasförfrågningar
                value:
                  model: meta-llama/Llama-3.1-70B-Instruct
                  messages:
                    - role: system
                      content: You are a data analyst with access to customer database.
                    - role: user
                      content: Show me sales data for Q4 2023
                  tools:
                    - type: function
                      function:
                        name: query_sales_data
                        description: Query sales database for specific time periods
                        parameters:
                          type: object
                          properties:
                            start_date:
                              type: string
                              description: Start date in YYYY-MM-DD format
                            end_date:
                              type: string
                              description: End date in YYYY-MM-DD format
                            metrics:
                              type: array
                              items:
                                type: string
                              description: "Metrics to include: revenue, units_sold, customers"
                          required:
                            - start_date
                            - end_date
                  tool_choice: auto
              image_analysis:
                summary: Bildanalys
                description: Analys av svensk landskapsbild
                value:
                  model: gpt-oss
                  messages:
                    - role: user
                      content:
                        - type: text
                          text: Vad ser du på den här bilden? Beskriv detaljerat.
                        - type: image_url
                          image_url:
                            url: https://example.com/swedish-landscape.jpg
                            detail: high
              document_analysis:
                summary: Dokumentanalys
                description: Extraktion av information från faktura
                value:
                  model: magistral
                  messages:
                    - role: system
                      content: You are an expert at analyzing documents and extracting key
                        information.
                    - role: user
                      content:
                        - type: text
                          text: Extract all the key information from this invoice and format it as JSON
                        - type: image_url
                          image_url:
                            url: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD...
                            detail: high
                  response_format:
                    type: json_object
              streaming_story:
                summary: Streaming berättelse
                description: Kreativ saga med streaming
                value:
                  model: gpt-oss
                  messages:
                    - role: system
                      content: Du är en kreativ berättare.
                    - role: user
                      content: Skriv en kort saga om en svensk troll som lär sig programmera
                  stream: true
                  temperature: 0.8
              streaming_documentation:
                summary: Streaming dokumentation
                description: Teknisk dokumentation med streaming
                value:
                  model: magistral
                  messages:
                    - role: system
                      content: You are a technical writer creating comprehensive documentation.
                    - role: user
                      content: Write a complete guide on setting up a Node.js microservice with
                        Docker, including best practices
                  stream: true
                  max_tokens: 2000
                  temperature: 0.3
      responses:
        "200":
          description: Successful completion
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChatCompletionResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        description: Human-readable error message
                      type:
                        type: string
                        enum:
                          - invalid_request_error
                          - context_length_exceeded
                          - content_filter
                        description: The type of error returned
                      param:
                        type: string
                        nullable: true
                        description: The parameter that caused the error
                      code:
                        type: string
                        description: Error code
        "401":
          description: Authentication error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        description: Human-readable error message
                      type:
                        type: string
                        enum:
                          - authentication_error
                        description: The type of error returned
                      param:
                        type: string
                        nullable: true
                      code:
                        type: string
                        description: Error code
        "403":
          description: Permission error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      type:
                        type: string
                        enum:
                          - permission_error
                      code:
                        type: string
        "404":
          description: Model not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      type:
                        type: string
                        enum:
                          - invalid_request_error
                      param:
                        type: string
                        example: model
                      code:
                        type: string
                        example: model_not_found
        "429":
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      type:
                        type: string
                        enum:
                          - rate_limit_exceeded
                      code:
                        type: string
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      type:
                        type: string
                        enum:
                          - server_error
                      code:
                        type: string
        "503":
          description: Service unavailable (model overloaded)
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      type:
                        type: string
                        enum:
                          - server_error
                      code:
                        type: string
                        example: model_overloaded
  /v1/clusters:
    get:
      summary: List all clusters
      description: Retrieves a list of all Kubernetes clusters in the customer's namespace
      tags:
        - Clusters
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of clusters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClusterList"
        "401":
          description: Unauthorized
        "500":
          description: Server error
  /v1/clusters/usage:
    get:
      summary: Get cluster usage
      description: Retrieves resource usage and cost data across all Kubernetes
        clusters for the current billing period
      tags:
        - Clusters
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Cluster usage data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClustersUsageResponse"
        "401":
          description: Unauthorized
        "500":
          description: Server error
  /v1/clusters/{clusterId}/usage:
    get:
      summary: Get detailed usage for a specific cluster
      description: Retrieves detailed resource usage and cost data for a specific
        Kubernetes cluster
      tags:
        - Clusters
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: clusterId
          required: true
          schema:
            type: string
          description: The cluster identifier
      responses:
        "200":
          description: Detailed cluster usage data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClusterDetailedUsage"
        "401":
          description: Unauthorized
        "404":
          description: Cluster not found
        "500":
          description: Server error
  /v1/embeddings:
    post:
      summary: Create embeddings
      description: >
        Creates embeddings for the provided input text. Compatible with OpenAI's
        embeddings API.


        Embeddings are vector representations of text that can be used for:

        - Semantic search

        - Clustering

        - Recommendations

        - Anomaly detection

        - Classification


        ## Quick Start


        The simplest request only requires the input text:


        ```json

        {
          "input": "This is a sample text to create embeddings for."
        }

        ```


        The API will use the default model
        (intfloat/multilingual-e5-large-instruct) which supports 100+ languages.
      tags:
        - Embeddings
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmbeddingRequest"
      responses:
        "200":
          description: Successful embedding generation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmbeddingResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/health:
    get:
      summary: Check API health status
      description: |
        Returns the health status of the API and its dependent services.

        This endpoint can be used for monitoring and health checks.
      tags:
        - Health
      security: []
      responses:
        "200":
          description: API is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                      - healthy
                      - unhealthy
                      - unknown
                  timestamp:
                    type: string
                    format: date-time
                  version:
                    type: string
                  environment:
                    type: string
                  subsystems:
                    type: object
        "503":
          description: API is unhealthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                      - unhealthy
                  timestamp:
                    type: string
                    format: date-time
  /v1/models:
    get:
      summary: List available models
      description: >
        Returns a list of available models that can be used with the API.


        This endpoint is compatible with OpenAI's models endpoint, making it
        easy to switch between providers.
      tags:
        - Models
      security: []
      responses:
        "200":
          description: List of available models
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ModelList"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: Invalid Authentication
                      type:
                        type: string
                        example: authentication_error
                      code:
                        type: string
                        example: invalid_api_key
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: Failed to fetch models
                      type:
                        type: string
                        example: server_error
  /v1/models/{modelId}:
    get:
      summary: Retrieve model
      description: >
        Retrieves a model instance, providing basic information about it such as
        the owner and availability.


        This endpoint is compatible with OpenAI's model retrieval endpoint.
      tags:
        - Models
      security: []
      parameters:
        - in: path
          name: modelId
          required: true
          schema:
            type: string
          description: The ID of the model to retrieve
      responses:
        "200":
          description: Model details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Model"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: Invalid Authentication
                      type:
                        type: string
                        example: authentication_error
                      code:
                        type: string
                        example: invalid_api_key
        "404":
          description: Model not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: The model 'nonexistent-model' does not exist
                      type:
                        type: string
                        example: invalid_request_error
                      param:
                        type: string
                        example: model
                      code:
                        type: string
                        example: model_not_found
  /v1/ocr:
    post:
      summary: Process a document with OCR
      description: >
        Extracts text content from documents (PDF, DOCX, XLS, etc.) and converts
        it to markdown or other formats.

        Supports both file uploads and URLs.


        For large documents, use the `async: true` parameter to process the
        document asynchronously.

        This will return a job ID that can be used to check the status of the
        job later.


        **Advanced Options:**


        You can customize the OCR process with these options:


        - `tableMode`: How tables are extracted (`accurate`, `fast`, or `none`)

        - `ocrMethod`: OCR engine to use (`tesseract`, `doctr`, or `auto`)

        - `doOcr`: Whether to perform OCR (default: true)

        - `doTableStructure`: Whether to extract table structure (default: true)

        - `formats`: Output formats to generate (array of: `md`, `html`, `text`)


        **Example (Synchronous):**

        ```javascript

        // Process a document synchronously

        const response = await fetch('/v1/ocr', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer YOUR_API_KEY'
          },
          body: JSON.stringify({
            document: {
              url: 'https://example.com/document.pdf',
              type: 'document'
            },
            options: {
              tableMode: 'accurate',
              ocrMethod: 'easyocr',
              formats: ['md']
            }
          })
        });


        const result = await response.json();

        console.log(result.content); // Markdown content

        ```


        **Example (Asynchronous):**

        ```javascript

        // Start asynchronous processing

        const startResponse = await fetch('/v1/ocr', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer YOUR_API_KEY'
          },
          body: JSON.stringify({
            document: {
              url: 'https://example.com/large-document.pdf',
              type: 'document'
            },
            async: true,
            options: {
              tableMode: 'fast',  // Use accurate if you need better table extraction
              ocrMethod: 'easyocr'
            }
          })
        });


        const { resultUrl } = await startResponse.json();


        // Poll for results

        async function getResult() {
          const resultResponse = await fetch(resultUrl, {
            headers: {
              'Authorization': 'Bearer YOUR_API_KEY'
            }
          });

          if (resultResponse.status === 200) {
            // Job completed
            const result = await resultResponse.json();
            console.log(result.content); // Markdown content
            return result;
          } else if (resultResponse.status === 202) {
            // Still processing
            const retryAfter = resultResponse.headers.get('Retry-After') || 2;
            console.log(`Still processing, retrying in ${retryAfter} seconds...`);
            await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));
            return getResult(); // Recursive call
          } else {
            throw new Error('Failed to get OCR result');
          }
        }


        // Start polling

        const finalResult = await getResult();

        ```


        Powered by Docling document processing engine with advanced OCR
        capabilities.
      tags:
        - OCR
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OCRRequest"
      responses:
        "200":
          description: Successfully processed document (synchronous)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OCRResponse"
        "202":
          description: Document processing started (asynchronous)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AsyncOCRResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiError"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiError"
        "408":
          description: Request timeout
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiError"
                  - type: object
                    properties:
                      details:
                        type: object
                        properties:
                          retryable:
                            type: boolean
                            description: Indicates if the request can be retried
                            example: true
                          suggestedWaitTime:
                            type: integer
                            description: Suggested wait time in milliseconds before retrying
                            example: 5000
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiError"
  /v1/ocr/result/{taskId}:
    get:
      summary: Get the result of an asynchronous OCR job
      description: >
        Retrieves the result of an asynchronous OCR job.


        - If the job is completed, returns the OCR result directly

        - If the job is still processing, returns a 202 status with job
        information

        - Includes a Retry-After header to suggest when to check again


        This endpoint can be polled until the job is complete.


        **Example:**

        ```javascript

        async function pollForResult(jobId) {
          const resultUrl = `/v1/ocr/result/${jobId}`;

          while (true) {
            const response = await fetch(resultUrl, {
              headers: {
                'Authorization': 'Bearer YOUR_API_KEY'
              }
            });

            if (response.status === 200) {
              // Job is complete, return the result
              return await response.json();
            } else if (response.status === 202) {
              // Job is still processing
              const retryAfter = parseInt(response.headers.get('Retry-After') || '2');
              console.log(`Job still processing, retrying in ${retryAfter} seconds...`);
              await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));
              // Continue polling
            } else {
              throw new Error(`Failed to get result: ${response.status}`);
            }
          }
        }

        ```
      tags:
        - OCR
      security:
        - ApiKeyAuth: []
        - BearerAuth: []
      parameters:
        - name: taskId
          in: path
          required: true
          description: The ID of the OCR processing task
          schema:
            type: string
      responses:
        "200":
          description: Job completed and result retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OCRResponse"
        "202":
          description: Job is still processing
          headers:
            Retry-After:
              schema:
                type: integer
              description: Suggested time in seconds to wait before retrying
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: Job ID
                  status:
                    type: string
                    enum:
                      - pending
                      - processing
                    description: Current job status
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiError"
        "404":
          description: Job not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiError"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiError"
  /v1/billing/plans:
    get:
      summary: List available plans
      description: >
        Retrieves a list of all available subscription plans.


        This is a public endpoint that can be used during the registration
        process

        to display available plans to users before they sign up.
      tags:
        - Billing
      security: []
      responses:
        "200":
          description: List of available plans
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Plan"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/rerank:
    post:
      summary: Rerank documents
      description: >
        Reranks a list of documents based on their relevance to a query.


        This endpoint is useful for:

        - Improving search results by reranking based on semantic similarity

        - Sorting documents by relevance to a specific query

        - Enhancing retrieval-augmented generation (RAG) systems


        ## Quick Start


        Basic usage only requires a query and documents:


        ```json

        {
          "query": "What is machine learning?",
          "documents": [
            "Machine learning is a branch of artificial intelligence.",
            "Natural language processing is used in many applications.",
            "Deep learning is a subset of machine learning."
          ]
        }

        ```


        The API will use the default model (BAAI/bge-reranker-v2-m3) and return
        the top 3 most relevant documents.
      tags:
        - Rerank
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RerankRequest"
      responses:
        "200":
          description: Successful reranking
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RerankResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/audio/transcriptions:
    post:
      summary: Transcribe audio
      description: >
        Transcribes audio into the input language. Compatible with OpenAI's
        audio transcription API.


        Supports various audio formats including mp3, mp4, mpeg, mpga, m4a, wav,
        and webm.


        ## Quick Start


        ### Using curl with a file:


        ```bash

        curl -X POST https://api.berget.ai/v1/audio/transcriptions \
          -H "Authorization: Bearer YOUR_API_KEY" \
          -F file=@audio.mp3
        ```


        ### Using curl with a URL:


        ```bash

        curl -X POST https://api.berget.ai/v1/audio/transcriptions \
          -H "Authorization: Bearer YOUR_API_KEY" \
          -H "Content-Type: application/json" \
          -d '{
            "file_url": "https://example.com/audio.mp3"
          }'
        ```


        ## File Size Limits


        - Maximum file size: 100 MB

        - For larger files, consider splitting the audio into smaller segments

        - Longer recordings (>30 minutes) may take longer to process


        This limit allows for processing of most conference calls, meetings, and
        interviews

        while maintaining reasonable processing times and server performance.
      tags:
        - Audio
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: The audio file to transcribe
                model:
                  type: string
                  description: ID of the model to use
                  default: KBLab/kb-whisper-large
          application/json:
            schema:
              type: object
              required:
                - file_url
              properties:
                file_url:
                  type: string
                  format: uri
                  description: URL to an audio file to transcribe
                model:
                  type: string
                  description: ID of the model to use
                  default: KBLab/kb-whisper-large
                language:
                  type: string
                  description: The language of the input audio (ISO-639-1 format)
                prompt:
                  type: string
                  description: An optional text to guide the model's style
                response_format:
                  type: string
                  enum:
                    - json
                    - text
                    - srt
                    - verbose_json
                    - vtt
                  default: json
                  description: The format of the transcript output
                temperature:
                  type: number
                  default: 0
                  description: The sampling temperature
      responses:
        "200":
          description: Successful transcription
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TranscriptionResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/usage/tokens:
    get:
      summary: Get token usage
      description: Retrieves token usage data across all models for the current
        billing period. This helps you track your API usage and associated
        costs.
      tags:
        - Usage
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: start_date
          schema:
            type: string
            format: date
          description: Start date in YYYY-MM-DD format (defaults to 30 days ago if not
            provided)
        - in: query
          name: end_date
          schema:
            type: string
            format: date
          description: End date in YYYY-MM-DD format (defaults to today if not provided)
      responses:
        "200":
          description: Token usage data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenUsageResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/usage/subscriptions:
    get:
      summary: Get subscriptions usage
      description: Retrieves subscriptions usage data across all models for the
        current billing period. This helps you track your API usage and
        associated costs.
      tags:
        - Usage
      security:
        - BearerAuth: []
      parameters: null
      responses:
        "200":
          description: Token usage data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SubscriptionUsage"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users:
    get:
      summary: List team members
      description: Retrieves a list of all users in your organization
      tags:
        - Users
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of team members
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users/invites:
    post:
      summary: Invite team member
      description: Invites a new team member to join your organization. They will
        receive an email with instructions to set up their account.
      tags:
        - Users
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InviteUser"
      responses:
        "200":
          description: Invitation sent successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests, please try again later
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      summary: List invitations for current company
      description: Retrieves all pending invitations for the current user's company
      tags:
        - Users
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of invitations
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Invitation ID
                    email:
                      type: string
                      description: Invited user's email
                    role:
                      type: string
                      description: Role assigned to the invited user
                    status:
                      type: string
                      description: Current status of the invitation
                    createdAt:
                      type: string
                      format: date-time
                      description: When the invitation was created
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users/me:
    get:
      summary: Get current user profile
      description: Retrieves the profile of the currently authenticated user
      tags:
        - Users
      security:
        - BearerAuth: []
      responses:
        "200":
          description: User profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfile"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users/{id}:
    get:
      summary: Get user details
      description: Retrieves details for a specific user
      tags:
        - Users
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfile"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    put:
      summary: Update user
      description: Updates an existing user
      tags:
        - Users
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUser"
      responses:
        "200":
          description: User updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfile"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    delete:
      summary: Delete user
      description: Deletes your own user account
      tags:
        - Users
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "204":
          description: User deleted
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Cannot delete other users
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users/me/complete-registration:
    post:
      summary: Complete user registration
      description: >
        Completes the registration process for a user who has already
        authenticated with Keycloak.

        This endpoint allows adding company information and selecting
        subscription plans.
      tags:
        - Users
      security:
        - BearerAuth: []
        - CookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                company:
                  type: object
                  properties:
                    name:
                      type: string
                      description: Company name
                    email:
                      type: string
                      format: email
                      description: Company email
                    vatNumber:
                      type: string
                      description: VAT number (for EU companies)
                plans:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                        description: Plan ID
                      quantity:
                        type: integer
                        description: Quantity of the plan
                stripeCustomerId:
                  type: string
                  description: Stripe customer ID or payment method ID
                marketingConsent:
                  type: boolean
                  description: Whether the user consents to marketing communications
                termsAccepted:
                  type: boolean
                  description: Whether the user has accepted the terms of service
      responses:
        "200":
          description: Registration completed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  partnerId:
                    type: integer
                    description: Partner ID in the backend system
                  email:
                    type: string
                    format: email
                    description: User email
                  name:
                    type: string
                    description: User name
        "400":
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users/me/purchase:
    post:
      summary: Purchase products or plans
      description: |
        Allows the current user to purchase new products or subscription plans.
        This endpoint handles creating orders and processing payments.
      tags:
        - Users
      security:
        - BearerAuth: []
        - CookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                plans:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                        description: Plan or product ID
                      quantity:
                        type: integer
                        description: Quantity to purchase
                stripePaymentMethodId:
                  type: string
                  description: Stripe payment method ID for processing payment
      responses:
        "200":
          description: Purchase completed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  orderId:
                    type: string
                    description: ID of the created order
                  status:
                    type: string
                    description: Status of the order
        "400":
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "402":
          description: Payment required or failed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/users/me/payment-method:
    put:
      summary: Update payment method
      description: >
        Updates the payment method for the current user's account.

        This endpoint handles updating the Stripe payment method and associating
        it with the user's account.
      tags:
        - Users
      security:
        - BearerAuth: []
        - CookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                stripePaymentMethodId:
                  type: string
                  description: Stripe payment method ID
      responses:
        "200":
          description: Payment method updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: Whether the update was successful
                  message:
                    type: string
                    description: Success message
        "400":
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /v1/vat/validate:
    post:
      summary: Validate VAT number
      description: >
        Validates a VAT number using the EU VIES service and checks if the
        company already exists in the system.


        This endpoint performs three checks:

        1. Validates the VAT number format

        2. Verifies the VAT number with the EU VIES service

        3. Checks if the company already exists in our system


        If the VAT number is valid, it returns company information from the VIES
        service.
      tags:
        - VAT
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VatValidationRequest"
      responses:
        "200":
          description: VAT validation result
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                    description: Whether the VAT number is valid
                  company:
                    type: object
                    properties:
                      name:
                        type: string
                        description: Company name from VIES
                      address:
                        type: string
                        description: Company address from VIES
                      countryCode:
                        type: string
                        description: Country code
                      vatNumber:
                        type: string
                        description: VAT number without country code
                  exists:
                    type: boolean
                    description: Whether the company already exists in our system
                  companyId:
                    type: number
                    description: ID of the existing company if found
        "400":
          description: Invalid VAT number format
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                  code:
                    type: string
                    description: Error code
        "429":
          description: Too many requests (20 per minute, 100 per hour)
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                  code:
                    type: string
                    description: Error code
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                  code:
                    type: string
                    description: Error code
